<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+CiAgPCEtLSBEYXJrIGJyb3duIGJhY2tncm91bmQgY2lyY2xlIC0tPgogIDxjaXJjbGUgY3g9IjE2IiBjeT0iMTYiIHI9IjE2IiBmaWxsPSIjMmUxYTBlIi8+CgogIDwhLS0gQ2FrZTogYm90dG9tIHRpZXIgLS0+CiAgPHJlY3QgeD0iNiIgeT0iMjEiIHdpZHRoPSIyMCIgaGVpZ2h0PSI2IiByeD0iMi41IiBmaWxsPSIjYzk5MzRhIi8+CiAgPCEtLSBDcmVhbSBkcmlwIGJvdHRvbSB0aWVyIC0tPgogIDxlbGxpcHNlIGN4PSIxNiIgY3k9IjIxIiByeD0iMTAiIHJ5PSIyLjIiIGZpbGw9IiNmNWUxYWYiLz4KCiAgPCEtLSBDYWtlOiB0b3AgdGllciAtLT4KICA8cmVjdCB4PSIxMCIgeT0iMTUiIHdpZHRoPSIxMiIgaGVpZ2h0PSI3IiByeD0iMiIgZmlsbD0iI2I4ODIzYyIvPgogIDwhLS0gQ3JlYW0gZHJpcCB0b3AgdGllciAtLT4KICA8ZWxsaXBzZSBjeD0iMTYiIGN5PSIxNSIgcng9IjYiIHJ5PSIxLjgiIGZpbGw9IiNmNWUxYWYiLz4KCiAgPCEtLSBCZXJyeSBkZWNvcmF0aW9ucyBvbiB0b3AgdGllciAtLT4KICA8Y2lyY2xlIGN4PSIxMyIgY3k9IjE0LjIiIHI9IjEuMyIgZmlsbD0iIzhiMWExYSIvPgogIDxjaXJjbGUgY3g9IjE2IiBjeT0iMTMuOCIgcj0iMS4zIiBmaWxsPSIjYzAzOTJiIi8+CiAgPGNpcmNsZSBjeD0iMTkiIGN5PSIxNC4yIiByPSIxLjMiIGZpbGw9IiM4YjFhMWEiLz4KCiAgPCEtLSBDYW5kbGUgLS0+CiAgPHJlY3QgeD0iMTUuMiIgeT0iOSIgd2lkdGg9IjEuNiIgaGVpZ2h0PSI1IiByeD0iMC44IiBmaWxsPSIjZjVlMWFmIi8+CgogIDwhLS0gRmxhbWUgb3V0ZXIgLS0+CiAgPGVsbGlwc2UgY3g9IjE2IiBjeT0iOC4yIiByeD0iMS40IiByeT0iMiIgZmlsbD0iI2M5OTM0YSIvPgogIDwhLS0gRmxhbWUgaW5uZXIgZ2xvdyAtLT4KICA8ZWxsaXBzZSBjeD0iMTYiIGN5PSI4LjYiIHJ4PSIwLjY1IiByeT0iMS4xIiBmaWxsPSIjZmZmOGU3Ii8+Cjwvc3ZnPgo=" type="image/svg+xml">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Milovi Cake — Торты и десерты на заказ в Санкт-Петербурге</title>
  <meta name="description" content="Авторские торты, бенто, 3D-торты, меренговые рулеты и десерты ручной работы на заказ в Санкт-Петербурге. Доставка по СПб. Заказ от 2 кг." />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Milovi Cake — Авторские торты на заказ в СПб" />
  <meta property="og:description" content="Нежнейшие торты и десерты ручной работы. Бисквитные, бенто, 3D-торты, меренговые рулеты, Павлова, капкейки." />
  <meta property="og:image" content="https://milovicake.ru/hero.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:url" content="https://milovicake.ru/" />
  <meta property="og:type" content="website" />
  <link rel="canonical" href="https://milovicake.ru/" />
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "Milovi Cake",
    "description": "Авторские торты, меренговые рулеты и десерты на заказ в Санкт-Петербурге.",
    "url": "https://milovicake.ru/",
    "telephone": "+79119038886",
    "address": {
      "@type": "PostalAddress",
      "streetAddress": "Пулковская ул., 19",
      "addressLocality": "Санкт-Петербург",
      "addressCountry": "RU"
    },
    "openingHours": "Mo-Su 10:00-20:00",
    "priceRange": "₽₽",
    "sameAs": [
      "https://vk.com/milovi_cake",
      "https://t.me/MiloviCake",
      "https://yandex.ru/maps/org/milovi_cake_torty_na_zakaz/89655951103/"
    ]
  }
  </script>
  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(106945185, "init", {
      clickmap: true,
      trackLinks: true,
      accurateTrackBounce: true,
      webvisor: true
    });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/106945185" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Jost:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --cream: #f5f0e8;
      --cream-dark: #ede5d5;
      --gold: #c9934a;
      --gold-light: #d4a76a;
      --brown: #3d2b1f;
      --brown-light: #6b4c38;
      --text: #2c1a10;
      --text-muted: #9a7a62;
      --white: #FDFBF7;
      --radius: 16px;
    }

    html { scroll-behavior: smooth; }

    ::selection {
      background: var(--gold);
      color: #fff;
    }

    h1, h2 {
      text-shadow: 2px 2px 4px rgba(90, 60, 40, 0.15);
      letter-spacing: -0.02em;
    }

    body {
      font-family: 'Jost', sans-serif;
      background: var(--cream);
      color: var(--text);
      overflow-x: hidden;
    }

    /* ── PROGRESS BAR ── */
    #scroll-progress {
      position: fixed;
      top: 0; left: 0;
      height: 3px;
      width: 0%;
      background: linear-gradient(90deg, var(--gold), var(--gold-light), #e8b87a);
      z-index: 9999;
      border-radius: 0 2px 2px 0;
      transition: width 0.08s linear;
      box-shadow: 0 0 8px rgba(201,147,74,0.5);
    }



    /* ── HEADER ── */
    .site-header {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 500;
      padding: 0 60px;
      height: 72px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: transparent;
      transition: background 0.35s, box-shadow 0.35s, backdrop-filter 0.35s;
    }
    .site-header.scrolled {
      background: rgba(245,240,232,0.92);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow: 0 2px 20px rgba(61,43,31,0.08);
    }
    .header-logo {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      font-weight: 300;
      color: rgba(255, 245, 220, 0.95);
      text-decoration: none;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      transition: color 0.3s;
      line-height: 72px;
      display: flex;
      align-items: center;
    }
    .site-header.scrolled .header-logo { color: var(--brown); }
    .header-logo { flex-direction: column; align-items: flex-start; justify-content: center; line-height: 1.2; }
    .header-logo-sub {
      display: block;
      font-family: 'Jost', sans-serif;
      font-size: 10px;
      font-weight: 300;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(255,235,185,0.45);
      line-height: 1;
      margin-top: 3px;
      transition: color 0.3s;
    }
    .site-header.scrolled .header-logo-sub { color: var(--text-muted); }

    .header-nav {
      display: flex;
      align-items: center;
      gap: 32px;
    }
    .header-nav a {
      font-size: 14px;
      font-weight: 400;
      color: rgba(255,255,255,0.88);
      text-decoration: none;
      letter-spacing: 0.04em;
      transition: color 0.2s;
      text-transform: uppercase;
      position: relative;
    }
    .header-nav a:not(.header-order)::after {
      content: '';
      position: absolute;
      left: 0; bottom: -3px;
      width: 100%; height: 1.5px;
      background: var(--gold);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.3s ease;
    }
    .header-nav a:not(.header-order):hover::after { transform: scaleX(1); }
    .site-header.scrolled .header-nav a { color: var(--brown-light); }
    .header-nav a:hover { color: var(--gold) !important; }
    .header-order {
      background: var(--gold);
      color: #fff !important;
      padding: 10px 22px;
      border-radius: 50px;
      font-size: 13px !important;
      font-weight: 500 !important;
      transition: background 0.2s, transform 0.15s !important;
    }
    .header-order:hover { background: var(--gold-light) !important; transform: translateY(-1px); }

    /* ── BURGER MENU ── */
    .burger-btn {
      display: none;
      flex-direction: column;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      z-index: 601;
    }
    .burger-btn span {
      display: block;
      width: 24px; height: 2px;
      background: #fff;
      border-radius: 2px;
      transition: transform 0.3s, opacity 0.3s, background 0.3s;
    }
    .site-header.scrolled .burger-btn span { background: var(--brown); }
    .burger-btn.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
    .burger-btn.open span:nth-child(2) { opacity: 0; }
    .burger-btn.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

    .mobile-menu {
      display: none;
      position: fixed;
      inset: 0;
      background: linear-gradient(160deg, #f5efe4 0%, #ede4d2 100%);
      backdrop-filter: blur(20px);
      z-index: 600;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.35s;
      box-shadow: inset 0 0 120px rgba(201,147,74,0.07);
    }
    .mobile-menu.open { opacity: 1; pointer-events: all; }
    
    /* Close button inside menu */
    .mobile-menu-close {
      position: absolute;
      top: 24px; right: 24px;
      background: rgba(201,147,74,0.12);
      border: 1.5px solid rgba(201,147,74,0.25);
      border-radius: 50px;
      padding: 10px 18px;
      display: flex; align-items: center; gap: 7px;
      color: var(--brown);
      font-family: 'Jost', sans-serif;
      font-size: 13px;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s;
    }
    .mobile-menu-close:hover { background: rgba(201,147,74,0.22); border-color: var(--gold); }

    .mobile-menu-nav {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      width: 100%;
      padding: 0 40px;
    }

    .mobile-menu a {
      font-family: 'Cormorant Garamond', serif;
      font-size: 46px;
      color: var(--brown);
      text-decoration: none;
      font-weight: 400;
      width: 100%;
      text-align: center;
      padding: 14px 24px;
      border-radius: 20px;
      position: relative;
      transition: color 0.25s, background 0.25s, letter-spacing 0.25s, transform 0.2s;
      letter-spacing: 0.01em;
    }
    .mobile-menu a::after {
      content: '';
      position: absolute;
      bottom: 10px; left: 50%;
      transform: translateX(-50%) scaleX(0);
      width: 40px; height: 2px;
      background: var(--gold);
      border-radius: 2px;
      transition: transform 0.25s, opacity 0.25s;
      opacity: 0;
    }
    .mobile-menu a:hover {
      color: var(--gold);
      background: rgba(201,147,74,0.07);
      letter-spacing: 0.06em;
      transform: translateX(4px);
    }
    .mobile-menu a:hover::after { transform: translateX(-50%) scaleX(1); opacity: 1; }

    /* Декоративная линия-разделитель */
    .mobile-menu-divider {
      width: 40px; height: 1px;
      background: rgba(201,147,74,0.3);
      margin: 12px auto;
    }

    /* Телефон внизу меню */
    .mobile-menu-phone {
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      gap: 10px;
      font-family: 'Jost', sans-serif !important;
      font-size: 20px !important;
      font-weight: 400;
      color: var(--brown);
      text-decoration: none;
      letter-spacing: 0.05em !important;
      padding: 14px 24px;
      border-radius: 20px;
      transition: color 0.25s, background 0.25s;
      width: 100%;
      text-align: center;
      transform: none !important;
    }
    .mobile-menu-phone:hover {
      color: var(--gold) !important;
      background: rgba(201,147,74,0.07);
      letter-spacing: 0.05em !important;
      transform: none !important;
    }
    .mobile-menu-phone svg {
      flex-shrink: 0;
    }

    @media (max-width: 768px) {
      .burger-btn { display: flex; }
      .header-nav { display: none; }
      .mobile-menu { display: flex; }
    }

    /* Hero padding */
    .hero { padding-top: 0; }

    /* ── HERO PHOTO BACKGROUND ── */
    .hero-photo-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
    }
    .hero-photo-bg img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: 68% center;
      display: block;
    }
    /* Gradient overlay: top gradient for header readability + left gradient for text safe area */
    .hero-photo-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background:
        linear-gradient(to bottom, rgba(10,6,3,0.38) 0%, transparent 22%),
        linear-gradient(to right, rgba(8,5,2,0.72) 0%, rgba(8,5,2,0.55) 30%, rgba(8,5,2,0.15) 55%, transparent 75%);
      pointer-events: none;
    }

    /* ── TOAST ── */
    .toast {
      position: fixed;
      bottom: 100px; left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: var(--brown);
      color: #fff;
      padding: 14px 24px;
      border-radius: 50px;
      font-size: 15px;
      z-index: 9990;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s, transform 0.3s;
      white-space: nowrap;
      box-shadow: 0 8px 24px rgba(61,43,31,0.25);
    }
    .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* ── FLOATING CTA ── */
    .floating-cta {
      position: fixed;
      bottom: 30px; left: 30px;
      background: linear-gradient(135deg, var(--gold), var(--gold-light));
      color: #fff;
      padding: 14px 28px;
      border-radius: 50px;
      font-family: 'Jost', sans-serif;
      font-size: 15px;
      font-weight: 500;
      text-decoration: none;
      z-index: 100;
      box-shadow: 0 8px 28px rgba(201,147,74,0.45);
      opacity: 0;
      transform: translateY(20px);
      pointer-events: none;
      transition: opacity 0.4s, transform 0.4s, box-shadow 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .floating-cta.visible { opacity: 1; transform: translateY(0); pointer-events: all; }
    .floating-cta:hover { box-shadow: 0 12px 36px rgba(201,147,74,0.6); transform: translateY(-2px); }

    /* ── STATS ── */
    .stats-section { background: var(--brown); padding: 60px; }
    .stats-grid {
      max-width: 1300px; margin: 0 auto;
      display: grid; grid-template-columns: repeat(4,1fr); gap: 32px; text-align: center;
    }
    .stat-num {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(48px,5vw,72px);
      color: var(--gold-light); font-weight: 600; line-height: 1; display: block;
    }
    .stat-label { font-size: 14px; color: rgba(255,255,255,0.65); margin-top: 8px; font-weight: 300; letter-spacing: 0.05em; text-transform: uppercase; }

    /* ── REVIEWS ── */
    .reviews-carousel { position: relative; display: flex; align-items: center; gap: 16px; }
    .reviews-track { flex: 1; overflow: hidden; position: relative; min-height: 500px; }
    .review-slide { position: absolute; inset: 0; opacity: 0; transition: opacity 0.5s ease; pointer-events: none; display: flex; justify-content: center; }
    .review-slide.active { opacity: 1; pointer-events: all; position: relative; }
    .review-card { background: var(--cream); border-radius: 24px; padding: 40px; max-width: 580px; width: 100%; box-shadow: 0 8px 40px rgba(61,43,31,0.08); }
    .review-quote { font-family: 'Cormorant Garamond', serif; font-size: 64px; color: var(--gold); line-height: 0.6; margin-bottom: 16px; opacity: 0.4; }
    .review-text { font-size: 16px; line-height: 1.7; color: var(--text); margin-bottom: 24px; font-style: italic; }
    .review-img-wrap { border-radius: 16px; overflow: hidden; max-height: 340px; cursor: zoom-in; }
    .review-img-wrap img { width: 100%; height: 100%; object-fit: cover; object-position: center top; display: block; transition: transform 0.3s; cursor: zoom-in; }
    .review-img-wrap:hover img { transform: scale(1.02); }
    .rev-arrow { width: 48px; height: 48px; border-radius: 50%; border: 1.5px solid var(--gold); background: none; color: var(--gold); font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: background 0.2s, color 0.2s; }
    .rev-arrow:hover { background: var(--gold); color: #fff; }
    .rev-dots { display: flex; justify-content: center; gap: 8px; margin-top: 28px; }
    .rev-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--cream-dark); cursor: pointer; transition: background 0.3s, transform 0.3s; }
    .rev-dot-active { background: var(--gold); transform: scale(1.3); }

    /* ── LIGHTBOX ── */
    .lightbox {
      position: fixed; inset: 0;
      background: rgba(10,5,0,0.92);
      z-index: 9000;
      display: flex; align-items: center; justify-content: center;
      opacity: 0; pointer-events: none;
      transition: opacity 0.3s;
    }
    .lightbox.open { opacity: 1; pointer-events: all; }
    .lightbox img {
      max-width: 90vw; max-height: 90vh;
      border-radius: 16px;
      box-shadow: 0 30px 80px rgba(0,0,0,0.6);
      object-fit: contain;
      transform: scale(0.92);
      transition: transform 0.3s;
    }
    .lightbox.open img { transform: scale(1); }
    .lightbox-close {
      position: absolute; top: 20px; right: 20px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.25);
      border-radius: 50px;
      padding: 8px 18px;
      display: flex; align-items: center; gap: 7px;
      color: #fff; cursor: pointer;
      font-family: 'Jost', sans-serif;
      font-size: 14px; font-weight: 400;
      letter-spacing: 0.03em;
      transition: background 0.2s, border-color 0.2s;
      z-index: 9001;
    }
    .lightbox-close:hover { background: rgba(255,255,255,0.25); border-color: rgba(255,255,255,0.5); }

    .fill-tag {
      display: inline-block;
      font-size: 10px;
      font-weight: 500;
      padding: 2px 7px;
      border-radius: 20px;
      margin-left: 5px;
      vertical-align: middle;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }
    .fill-tag.hit { background: #e8442a; color: #fff; }
    .fill-tag.nuts { background: #8b6914; color: #fff; }
    .lightbox-nav {
      position: absolute;
      bottom: 28px; left: 50%; transform: translateX(-50%);
      display: flex; align-items: center; gap: 16px;
      z-index: 9001;
    }
    .lightbox-nav.hidden { opacity: 0; pointer-events: none; }
    .lightbox-arrow {
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 50%;
      width: 44px; height: 44px;
      display: flex; align-items: center; justify-content: center;
      color: #fff; cursor: pointer;
      transition: background 0.2s, transform 0.15s;
    }
    .lightbox-arrow:hover { background: rgba(255,255,255,0.28); transform: scale(1.1); }
    @media (max-width: 600px) {
      .lightbox-nav { bottom: 18px; gap: 12px; }
      .lightbox-arrow { width: 38px; height: 38px; }
    }

    /* ── CALCULATOR ── */
    #calculator { background: linear-gradient(180deg, #faf6ef 0%, #f0e6d4 100%); }
    .calc-wrap {
      max-width: 700px; margin: 0 auto;
      background: var(--white); border-radius: 28px;
      padding: 48px; box-shadow: 0 12px 60px rgba(61,43,31,0.1);
    }
    .calc-row { margin-bottom: 28px; }
    .calc-row label { display: block; font-size: 13px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 12px; }
    .calc-options { display: flex; flex-wrap: wrap; gap: 7px; }
    .calc-opt {
      position: relative;
      padding: 7px 14px; border-radius: 50px;
      border: 1.5px solid var(--cream-dark);
      background: var(--cream); color: var(--brown);
      font-family: 'Jost', sans-serif; font-size: 13px;
      cursor: pointer; transition: border-color 0.2s, background 0.2s, color 0.2s;
      user-select: none;
      display: inline-flex; align-items: center; gap: 5px;
    }
    .calc-opt.selected { border-color: var(--gold); background: var(--gold); color: #fff; box-shadow: 0 4px 14px rgba(201,147,74,0.45); }
    .calc-opt.selected .fill-tag { background: rgba(255,255,255,0.25); color: #fff; }

    /* ── FILL TOOLTIP ── */
    .fill-tooltip {
      position: absolute;
      bottom: calc(100% + 10px);
      left: 50%; transform: translateX(-50%);
      background: var(--brown);
      color: rgba(255,240,210,0.95);
      font-size: 12px; line-height: 1.55;
      padding: 10px 14px;
      border-radius: 12px;
      width: 220px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.18s, transform 0.18s;
      transform: translateX(-50%) translateY(4px);
      z-index: 200;
      box-shadow: 0 8px 24px rgba(0,0,0,0.18);
      white-space: normal;
      text-align: left;
    }
    .fill-tooltip::after {
      content: '';
      position: absolute;
      top: 100%; left: 50%; transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--brown);
    }
    .fill-tooltip strong { color: #fff; font-weight: 500; display: none; margin-bottom: 3px; }
    .calc-opt:hover .fill-tooltip,
    .calc-opt:focus .fill-tooltip {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Mobile: tap shows tooltip as bottom sheet style */
    .fill-mobile-popup {
      display: none;
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: var(--brown);
      color: rgba(255,240,210,0.95);
      padding: 20px 24px 32px;
      border-radius: 20px 20px 0 0;
      z-index: 800;
      font-size: 14px; line-height: 1.6;
      box-shadow: 0 -8px 32px rgba(0,0,0,0.25);
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }
    .fill-mobile-popup.open { transform: translateY(0); }
    .fill-mobile-popup strong { color: #fff; font-size: 16px; font-weight: 500; display: block; margin-bottom: 8px; }
    .fill-mobile-popup-close {
      position: absolute; top: 14px; right: 18px;
      background: rgba(255,255,255,0.12); border: none; border-radius: 50%;
      width: 30px; height: 30px; color: #fff; font-size: 18px;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
    }
    .fill-mobile-overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.4); z-index: 799;
    }
    .fill-mobile-overlay.open { display: block; }    /* ── WEIGHT STEPPER (cart style) ── */
    .calc-weight-stepper {
      display: inline-flex;
      align-items: center;
      background: var(--cream);
      border: 2px solid var(--cream-dark);
      border-radius: 50px;
      overflow: hidden;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .calc-weight-stepper:focus-within {
      border-color: var(--gold);
      box-shadow: 0 0 0 3px rgba(201,147,74,0.12);
    }
    .calc-stepper-btn {
      width: 48px; height: 48px;
      border: none;
      background: transparent;
      color: var(--brown);
      font-size: 22px;
      font-weight: 300;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.15s, color 0.15s;
      flex-shrink: 0;
      line-height: 1;
      user-select: none;
    }
    .calc-stepper-btn:hover { background: var(--gold); color: #fff; }
    .calc-stepper-btn:active { transform: scale(0.92); }
    .calc-stepper-btn:disabled { opacity: 0.3; cursor: not-allowed; }
    .calc-stepper-btn:disabled:hover { background: transparent; color: var(--brown); }
    .calc-stepper-val {
      font-family: 'Cormorant Garamond', serif;
      font-size: 24px;
      font-weight: 500;
      color: var(--gold);
      min-width: 90px;
      text-align: center;
      line-height: 1;
      letter-spacing: 0.01em;
    }

    /* ── FILL DESCRIPTIONS ── */
    .fill-desc-panel {
      margin-top: 14px;
      padding: 14px 18px;
      background: linear-gradient(135deg, rgba(201,147,74,0.06), rgba(201,147,74,0.03));
      border: 1px solid rgba(201,147,74,0.2);
      border-radius: 14px;
      min-height: 48px;
      transition: opacity 0.25s;
    }
    .fill-desc-text {
      font-size: 13px;
      color: var(--brown-light);
      line-height: 1.6;
      font-weight: 300;
    }
    .fill-desc-text strong {
      font-weight: 500;
      color: var(--brown);
    }
    .calc-result {
      background: var(--brown); border-radius: 20px;
      padding: 28px 32px; margin-top: 8px;
      display: flex; align-items: center; justify-content: space-between; gap: 16px; flex-wrap: wrap;
    }
    .calc-result-label { color: rgba(255,255,255,0.7); font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em; }
    .calc-result-price { font-family: 'Cormorant Garamond', serif; font-size: 42px; color: var(--gold-light); font-weight: 600; }
    .calc-result-note { font-size: 12px; color: rgba(255,255,255,0.45); margin-top: 4px; }
    .calc-approx-badge {
      display: inline-flex; align-items: center; gap: 5px;
      background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
      border-radius: 50px; padding: 3px 10px;
      font-size: 11px; color: rgba(255,255,255,0.7);
      margin-top: 6px; letter-spacing: 0.03em;
      opacity: 0; transform: translateY(4px);
      transition: opacity 0.3s, transform 0.3s;
    }
    .calc-approx-badge.visible { opacity: 1; transform: translateY(0); }
    .calc-order-btn {
      background: var(--gold); color: #fff;
      border: none; padding: 14px 28px; border-radius: 50px;
      font-family: 'Jost', sans-serif; font-size: 15px; font-weight: 500;
      cursor: pointer; transition: background 0.2s, transform 0.15s;
      text-decoration: none; display: inline-block;
    }
    .calc-order-btn:hover { background: var(--gold-light); transform: translateY(-2px); }

    /* ── PRODUCT CARD HOVER OVERLAY ── */
    .product-card { position: relative; }
    .slider-wrap, .product-img, .product-img-ph {
      transition: transform 0.4s ease;
    }
    .product-card:hover .slider-wrap,
    .product-card:hover .product-img,
    .product-card:hover .product-img-ph {
      transform: scale(1.04);
    }

    /* tooltip on hover (desktop) */
    .bento-seg-opt {
      position: relative;
    }
    .bento-seg-opt::after {
      content: attr(data-tip);
      position: absolute;
      bottom: calc(100% + 7px);
      left: 50%;
      transform: translateX(-50%);
      background: #3d2b1f;
      color: #fff;
      font-size: 11px;
      font-family: 'Jost', sans-serif;
      letter-spacing: 0.02em;
      white-space: nowrap;
      padding: 4px 9px;
      border-radius: 8px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 20;
    }
    .bento-seg-opt::before {
      content: '';
      position: absolute;
      bottom: calc(100% + 2px);
      left: 50%;
      transform: translateX(-50%);
      border: 5px solid transparent;
      border-top-color: #3d2b1f;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 20;
    }
    @media (hover: hover) {
      .bento-seg-opt:hover::after,
      .bento-seg-opt:hover::before {
        opacity: 1;
      }
    }

    /* mobile toast */
    .bento-weight-toast {
      position: fixed;
      bottom: 90px;
      left: 50%;
      transform: translateX(-50%) translateY(8px);
      background: #3d2b1f;
      color: #fff;
      font-family: 'Jost', sans-serif;
      font-size: 13px;
      padding: 8px 18px;
      border-radius: 20px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 9999;
      white-space: nowrap;
    }
    .bento-weight-toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* ── BENTO INLINE SWITCHER ── */
    .bento-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 0;
    }
    .bento-header-row h3 {
      margin-bottom: 0;
    }
    .bento-seg {
      display: inline-flex;
      align-items: center;
      background: #F3E9DB;
      border-radius: 20px;
      padding: 3px;
      gap: 0;
      flex-shrink: 0;
    }
    .bento-seg-opt {
      font-family: 'Jost', sans-serif;
      font-size: 11px;
      font-weight: 400;
      letter-spacing: 0.03em;
      padding: 3px 8px;
      border-radius: 20px;
      cursor: pointer;
      color: #9a7f68;
      background: transparent;
      transition: background 0.18s, color 0.18s, box-shadow 0.18s;
      user-select: none;
      white-space: nowrap;
    }
    .bento-seg-opt:hover {
      color: #3d2b1f;
    }
    .bento-seg-opt.active {
      background: #fff;
      color: #3d2b1f;
      box-shadow: 0 1px 5px rgba(0,0,0,.10);
    }

    h1, h2, h3, h4 {
      font-family: 'Cormorant Garamond', serif;
      font-weight: 500;
    }

    /* ── HERO ── */
    .hero {
      min-height: 100vh;
      display: flex;
      align-items: center;
      padding: 100px 60px 80px;
      position: relative;
      overflow: hidden;
    }

    /* Dark hero background */
    .hero-dark-bg {
      position: absolute;
      inset: 0;
      z-index: 0;
      background:
        radial-gradient(ellipse at 20% 50%, rgba(201,147,74,0.12) 0%, transparent 60%),
        radial-gradient(ellipse at 80% 20%, rgba(201,147,74,0.08) 0%, transparent 50%),
        linear-gradient(135deg, #0d0805 0%, #1a1009 40%, #120c06 70%, #0a0703 100%);
      overflow: hidden;
    }
    /* Subtle grain texture */
    .hero-dark-bg::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
      opacity: 0.35;
      pointer-events: none;
    }
    /* Gold shimmer line */
    .hero-dark-bg::after {
      content: '';
      position: absolute;
      inset: 0;
      background:
        linear-gradient(90deg, transparent 0%, rgba(201,147,74,0.06) 50%, transparent 100%),
        linear-gradient(180deg, rgba(201,147,74,0.04) 0%, transparent 40%, transparent 70%, rgba(201,147,74,0.03) 100%);
      pointer-events: none;
    }

    /* Floating orbs */
    .hero-orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      pointer-events: none;
      animation: orbFloat 8s ease-in-out infinite;
    }
    .hero-orb-1 {
      width: 500px; height: 500px;
      background: radial-gradient(circle, rgba(201,147,74,0.18) 0%, transparent 70%);
      top: -100px; left: -100px;
      animation-duration: 10s;
    }
    .hero-orb-2 {
      width: 350px; height: 350px;
      background: radial-gradient(circle, rgba(180,120,50,0.12) 0%, transparent 70%);
      bottom: -80px; right: 10%;
      animation-duration: 13s;
      animation-delay: -4s;
    }
    .hero-orb-3 {
      width: 250px; height: 250px;
      background: radial-gradient(circle, rgba(220,170,90,0.1) 0%, transparent 70%);
      top: 40%; left: 50%;
      animation-duration: 9s;
      animation-delay: -2s;
    }
    @keyframes orbFloat {
      0%, 100% { transform: translateY(0) scale(1); }
      50%       { transform: translateY(-30px) scale(1.05); }
    }

    /* Text colours adapted for dark background */
    .hero-text .hero-title { color: rgba(245, 225, 175, 0.78); }
    .hero-text p  { color: rgba(255, 235, 185, 0.65); }
    .btn-phone    { color: rgba(255,255,255,0.95); border-color: rgba(255,255,255,0.35); }
    .btn-phone:hover { border-color: var(--gold); background: rgba(201,147,74,0.15); }
    .hero .btn-phone { color: rgba(255,255,255,0.72) !important; border-color: rgba(255,255,255,0.28) !important; }

    .hero-content {
      max-width: 1300px;
      width: 100%;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: relative;
      z-index: 1;
    }

    .hero-title {
      font-size: clamp(52px, 6vw, 84px);
      line-height: 1.05;
      color: rgba(245, 225, 175, 0.78);
      margin-bottom: 12px;
      animation: fadeUp 0.8s ease both;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 400;
    }

    .hero-title .hero-title-brand {
      display: block;
    }

    .hero-title .hero-title-seo {
      display: block;
      font-size: clamp(16px, 1.6vw, 22px);
      font-weight: 300;
      letter-spacing: 0.01em;
      color: rgba(245, 225, 175, 0.42);
      line-height: 1.4;
      font-family: 'Jost', sans-serif;
      margin-top: 6px;
    }

    .hero-text p {
      font-size: clamp(18px, 2vw, 24px);
      color: rgba(255, 235, 185, 0.62);
      line-height: 1.5;
      margin-bottom: 40px;
      font-weight: 300;
      animation: fadeUp 0.8s 0.15s ease both;
    }

    .hero-actions {
      display: flex;
      gap: 16px;
      align-items: center;
      flex-wrap: wrap;
      animation: fadeUp 0.8s 0.3s ease both;
    }

    .btn-primary {
      background: var(--gold);
      color: var(--white);
      border: none;
      padding: 16px 36px;
      border-radius: 50px;
      font-family: 'Jost', sans-serif;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s, letter-spacing 0.3s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary:hover { background: var(--gold-light); transform: translateY(-2px); letter-spacing: 0.05em; }

    .btn-phone {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      color: var(--brown);
      font-size: 16px;
      font-weight: 500;
      text-decoration: none;
      padding: 14px 20px;
      border-radius: 50px;
      border: 1.5px solid rgba(61,43,31,0.2);
      transition: border-color 0.2s, background 0.2s;
    }
    .btn-phone:hover { border-color: var(--gold); background: rgba(201,147,74,0.05); }

    .hero-image {
      animation: fadeIn 1s 0.2s ease both;
    }

    .hero-image img {
      width: 100%;
      max-width: 560px;
      border-radius: 24px;
      object-fit: cover;
      aspect-ratio: 4/3;
      display: block;
      margin-left: auto;
      box-shadow: 0 30px 80px rgba(61,43,31,0.2);
    }

    /* Video wrap */
    .hero-video-wrap {
      position: relative;
      overflow: hidden;
      border-radius: 24px;
      box-shadow: 0 30px 80px rgba(61,43,31,0.22);
      background: #1a1209;
      width: 100%;
      max-width: 560px;
      aspect-ratio: 4/3;
      margin-left: auto;
    }

    /* placeholder image */
    .hero-img-wrap {
      width: 100%;
      max-width: 560px;
      aspect-ratio: 4/3;
      border-radius: 24px;
      margin-left: auto;
      box-shadow: 0 30px 80px rgba(61,43,31,0.22);
      overflow: hidden;
      position: relative;
    }

    .hero-img-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* Zoom into the hands + cake cutting area */
      object-position: 72% 38%;
      transform: scale(1.18);
      transform-origin: 72% 38%;
      display: block;
      transition: transform 6s ease;
    }

    .hero-img-wrap:hover img {
      transform: scale(1.25);
    }

    /* ── SECTION BASE ── */
    section { padding: 100px 60px; }

    .section-title {
      text-align: center;
      font-size: clamp(42px, 5vw, 72px);
      color: var(--brown);
      margin-bottom: 0;
      text-shadow: 2px 2px 4px rgba(90, 60, 40, 0.15);
      letter-spacing: -0.02em;
    }

    .section-sub {
      text-align: center;
      color: var(--text-muted);
      font-size: 17px;
      margin-top: 48px;
      margin-bottom: 64px;
      font-weight: 300;
    }

    .container { max-width: 1300px; margin: 0 auto; }

    /* ── CATALOG ── */
    #catalog { background: linear-gradient(to bottom, #e8dece 0px, var(--white) 80px); }

    /* ── PREMIUM GRAIN TEXTURE on white sections ── */
    #catalog, #reviews {
      position: relative;
      isolation: isolate;
    }
    #catalog::before, #reviews::before {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: 0.06;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='1'/%3E%3C/svg%3E");
      background-repeat: repeat;
      background-size: 200px 200px;
    }
    #catalog > *, #reviews > * {
      position: relative;
      z-index: 1;
    }

    .catalog-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
    }

    .product-card {
      border-radius: var(--radius);
      overflow: hidden;
      background: var(--cream);
      box-shadow: 0 10px 25px -5px rgba(90, 60, 40, 0.15);
      transition: all 0.4s ease;
    }

    .product-card:hover {
      transform: translateY(-7px);
      box-shadow: 0 20px 30px -10px rgba(90, 60, 40, 0.25), 0 0 0 1.5px rgba(201,147,74,0.35);
    }
    .product-card::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: var(--radius);
      border: 1.5px solid transparent;
      transition: border-color 0.35s ease;
      pointer-events: none;
    }
    .product-card:hover::after {
      border-color: rgba(201,147,74,0.45);
    }
    .product-card { position: relative; }

    .product-img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      display: block;
    }

    /* ── SLIDER ── */
    .slider-wrap {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      overflow: hidden;
      background: #1a1a1a;
    }

    .slide-img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.9s ease;
      display: block;
      cursor: zoom-in;
    }

    .slide-img.active { opacity: 1; }

    /* Video slide */
    .slide-video {
      object-fit: unset;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide-video-play {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 5;
      text-decoration: none;
      transition: background 0.2s;
    }
    .slide-video-play:hover { background: rgba(0,0,0,0.15); }

    .vk-play-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      filter: drop-shadow(0 4px 16px rgba(0,0,0,0.5));
      transition: transform 0.2s;
    }
    .slide-video-play:hover .vk-play-btn { transform: scale(1.07); }

    .vk-play-label {
      display: flex;
      align-items: center;
      background: rgba(0,0,0,0.6);
      color: white;
      font-family: 'Jost', sans-serif;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: 0.03em;
      padding: 6px 14px;
      border-radius: 20px;
      white-space: nowrap;
      backdrop-filter: blur(4px);
    }

    /* Video dot marker */
    .dot-video::after {
      content: '▶';
      position: absolute;
      font-size: 6px;
      top: -1px;
      right: -8px;
      color: rgba(255,255,255,0.8);
    }
    .dot-video { position: relative; }

    .slider-dots {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 7px;
      z-index: 10;
    }

    .dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: rgba(255,255,255,0.45);
      cursor: pointer;
      transition: background 0.3s, transform 0.3s;
    }

    .dot.active { background: #fff; transform: scale(1.35); }

    .product-img-ph {
      width: 100%;
      aspect-ratio: 1/1;
      background: linear-gradient(135deg, #e8d8c4, #d4b896);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
    }

    .product-info { padding: 20px 20px 24px; }

    .product-info h3 {
      font-size: 22px;
      color: var(--brown);
      margin-bottom: 6px;
    }

    .product-info .desc {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 4px;
      line-height: 1.5;
      font-weight: 300;
    }

    .product-info .min-order {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 16px;
      font-weight: 300;
    }

    .product-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: nowrap;
    }

    .price {
      font-family: 'Cormorant Garamond', serif;
      font-size: 20px;
      color: var(--gold);
      font-weight: 500;
      flex-shrink: 1;
      min-width: 0;
      text-shadow: 0 0 12px rgba(201, 147, 74, 0.45);
    }

    .btn-add {
      background: var(--gold);
      color: var(--white);
      border: none;
      padding: 10px 18px;
      border-radius: 50px;
      font-family: 'Jost', sans-serif;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s, transform 0.15s;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .btn-add:hover { background: var(--gold-light); transform: scale(1.04); }

    /* ── WHY US ── */
    #why { 
      background: linear-gradient(180deg, #faf6ef 0%, #f0e6d4 100%);
      padding-top: 100px;
      padding-bottom: 100px;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 32px;
      text-align: center;
      margin-top: 64px;
    }

    .feature-icon {
      width: 64px; height: 64px;
      border-radius: 50%;
      background: rgba(201,147,74,0.12);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 16px;
      font-size: 26px;
    }

    .feature h4 {
      font-size: 18px;
      color: var(--brown);
      margin-bottom: 8px;
    }

    .feature p {
      font-size: 14px;
      color: var(--text-muted);
      line-height: 1.6;
      font-weight: 300;
    }

    /* ── CONTACTS ── */
    #contacts { background: linear-gradient(135deg, #f0e8d8 0%, #e8dcc8 100%); }

    .contacts-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
    }

    .card {
      background: var(--white);
      border-radius: 20px;
      padding: 40px;
    }

    .card h3 {
      font-size: 28px;
      color: var(--brown);
      margin-bottom: 8px;
    }

    .card .hours {
      font-size: 14px;
      color: var(--gold);
      margin-bottom: 32px;
      font-weight: 400;
    }

    .contact-item {
      display: flex;
      align-items: flex-start;
      gap: 16px;
      margin-bottom: 24px;
    }

    .contact-icon {
      width: 48px; height: 48px;
      border-radius: 50%;
      background: var(--cream);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
    }

    .contact-item .label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .contact-item .value {
      font-size: 18px;
      font-weight: 500;
      color: var(--brown);
    }

    .contact-social-btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 500;
      text-decoration: none;
      transition: transform 0.15s, box-shadow 0.15s;
      font-family: 'Jost', sans-serif;
    }
    .contact-social-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.12); }
    .vk-btn  { background: #0077FF; color: #fff; }
    .ya-btn  { background: #FC3F1D; color: #fff; }
    .tg-btn  { background: #2AABEE; color: #fff; }
    .yt-btn  { background: #FF0000; color: #fff; }
    .google-btn { background: #4285F4; color: #fff; }

    .contact-item:has(.contact-social-btn) { align-items: center; }

    .btn-wa {
      display: block;
      width: 100%;
      margin-top: 32px;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
      color: var(--white);
      border: none;
      padding: 18px 32px;
      border-radius: 50px;
      font-family: 'Jost', sans-serif;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      letter-spacing: 0.03em;
      box-shadow: 0 8px 24px rgba(201,147,74,0.40), 0 2px 8px rgba(201,147,74,0.2);
      transition: background 0.25s, transform 0.18s, box-shadow 0.25s;
      position: relative;
      overflow: hidden;
    }
    .btn-wa::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.12) 0%, transparent 60%);
      border-radius: inherit;
      pointer-events: none;
    }
    .btn-wa:hover {
      background: linear-gradient(135deg, var(--gold-light) 0%, #e8c080 100%);
      transform: translateY(-3px);
      box-shadow: 0 14px 36px rgba(201,147,74,0.50), 0 4px 12px rgba(201,147,74,0.25);
    }
    .btn-wa:active { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(201,147,74,0.35); }

    /* ── CONTACT PRIMARY ITEMS ── */
    .contact-primary {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin: 20px 0 24px;
    }
    .contact-primary-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 18px;
      background: var(--cream);
      border-radius: 14px;
      text-decoration: none;
      color: inherit;
      border: 1px solid var(--cream-dark);
      transition: border-color 0.2s, box-shadow 0.2s, transform 0.15s;
    }
    .contact-primary-item:hover {
      border-color: var(--gold);
      box-shadow: 0 4px 16px rgba(201,147,74,0.12);
      transform: translateY(-1px);
    }
    .contact-primary-icon {
      width: 38px; height: 38px;
      border-radius: 50%;
      background: var(--white);
      border: 1px solid var(--cream-dark);
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
      color: var(--gold);
    }
    .contact-primary-label {
      font-size: 12px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 2px;
    }
    .contact-primary-value {
      font-size: 15px;
      color: var(--brown);
      font-weight: 500;
    }

    /* ── SOCIAL DIVIDER ── */
    .social-divider {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 24px 0 16px;
    }
    .social-divider::before,
    .social-divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--cream-dark);
    }
    .social-divider span {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      white-space: nowrap;
    }

    /* ── SOCIAL LINKS ── */
    .social-links {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .social-link {
      display: inline-flex;
      align-items: center;
      gap: 7px;
      padding: 9px 14px;
      border-radius: 50px;
      font-size: 13px;
      font-weight: 500;
      text-decoration: none;
      transition: opacity 0.2s, transform 0.15s;
      flex: 1;
      min-width: fit-content;
      justify-content: center;
    }
    .social-link:hover { opacity: 0.85; transform: translateY(-1px); }
    .social-link.vk     { background: #0077FF22; color: #0077FF; border: 1px solid #0077FF33; }
    .social-link.tg     { background: #2AABEE22; color: #0088cc; border: 1px solid #2AABEE33; }
    .social-link.yt     { background: #FF000018; color: #cc0000; border: 1px solid #FF000025; }
    .social-link.ya     { background: #FC3F1D18; color: #cc2200; border: 1px solid #FC3F1D25; }
    .social-link.google { background: #4285F418; color: #2a6dd9; border: 1px solid #4285F425; }

    /* ── BTN-WA with icon flex ── */
    .btn-wa { display: flex; align-items: center; justify-content: center; gap: 10px; }

    /* Form */
    .form-group { margin-bottom: 18px; }

    .form-group label {
      display: block;
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 14px 18px;
      border: 1.5px solid #e8ddd0;
      border-radius: 12px;
      font-family: 'Jost', sans-serif;
      font-size: 15px;
      background: var(--cream);
      color: var(--text);
      outline: none;
      transition: border-color 0.2s;
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder { color: var(--text-muted); }

    .form-group input:focus,
    .form-group textarea:focus { border-color: var(--gold); }

    .form-group textarea { resize: vertical; min-height: 100px; }

    .form-note {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 14px;
      line-height: 1.5;
    }
    .form-note a { color: var(--gold); }

    /* ── CART ── */
    .cart-btn {
      position: fixed;
      bottom: 90px; right: 30px;
      width: 60px; height: 60px;
      border-radius: 50%;
      background: var(--gold);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 8px 24px rgba(201,147,74,0.4);
      z-index: 100;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .cart-btn:hover { transform: scale(1.1); box-shadow: 0 12px 32px rgba(201,147,74,0.5); }

    .cart-badge {
      position: absolute;
      top: -4px; right: -4px;
      background: var(--brown);
      color: var(--white);
      width: 22px; height: 22px;
      border-radius: 50%;
      font-size: 12px;
      font-weight: 600;
      display: none;
      align-items: center;
      justify-content: center;
      font-family: 'Jost', sans-serif;
    }
    .cart-badge.visible { display: flex; }

    /* Cart drawer */
    .cart-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.4);
      z-index: 700;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    .cart-overlay.open { opacity: 1; pointer-events: all; }

    .cart-drawer {
      position: fixed;
      top: 0; right: -420px;
      width: 420px;
      max-width: 100vw;
      height: 100%;
      height: 100dvh;
      background: var(--white);
      z-index: 701;
      transition: right 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .cart-drawer.open { right: 0; }

    .cart-header {
      padding: 16px 28px;
      border-bottom: 1px solid var(--cream-dark);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .cart-header h3 {
      font-size: 22px;
      color: var(--brown);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .cart-count-badge {
      background: var(--gold);
      color: var(--white);
      width: 24px; height: 24px;
      border-radius: 50%;
      font-size: 13px;
      font-family: 'Jost', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .cart-close {
      background: var(--cream);
      border: 1.5px solid var(--cream-dark);
      border-radius: 12px;
      cursor: pointer;
      color: var(--brown);
      padding: 10px 16px;
      min-width: 56px;
      min-height: 48px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2px;
      transition: background 0.2s, border-color 0.2s;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .cart-close:hover { background: var(--cream-dark); border-color: var(--gold); }

    /* ── CART PROGRESS ── */
    .cart-progress {
      display: flex;
      align-items: center;
      padding: 10px 28px;
      border-bottom: 1px solid var(--cream-dark);
      background: var(--cream);
    }
    .cart-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      flex-shrink: 0;
    }
    .cart-step-dot {
      width: 26px; height: 26px;
      border-radius: 50%;
      border: 2px solid var(--cream-dark);
      background: var(--white);
      color: var(--text-muted);
      font-size: 12px;
      font-family: 'Jost', sans-serif;
      font-weight: 600;
      display: flex; align-items: center; justify-content: center;
      transition: background 0.35s, border-color 0.35s, color 0.35s;
    }
    .cart-step span {
      font-size: 10px;
      color: var(--text-muted);
      font-family: 'Jost', sans-serif;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      transition: color 0.35s;
    }
    .cart-step[onclick]:hover .cart-step-dot {
      transform: scale(1.1);
      box-shadow: 0 0 0 3px rgba(201,147,74,0.2);
    }
    .cart-step[onclick]:hover span {
      color: var(--gold);
    }
    .cart-step.active .cart-step-dot {
      background: var(--gold);
      border-color: var(--gold);
      color: #fff;
      box-shadow: 0 2px 10px rgba(201,147,74,0.4);
    }
    .cart-step.active span { color: var(--gold); font-weight: 500; }
    .cart-step.done .cart-step-dot {
      background: var(--brown);
      border-color: var(--brown);
      color: #fff;
    }
    .cart-step-line {
      flex: 1;
      height: 2px;
      background: var(--cream-dark);
      margin: 0 8px;
      margin-bottom: 14px;
      border-radius: 2px;
      position: relative;
      overflow: hidden;
    }
    .cart-step-line::after {
      content: '';
      position: absolute;
      inset: 0;
      background: var(--gold);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform 0.5s ease;
      border-radius: 2px;
    }
    .cart-step-line.done::after { transform: scaleX(1); }

    .cart-body { 
      flex: 1; 
      overflow-y: auto; 
      overflow-x: hidden;
      padding: 14px 28px;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
      touch-action: pan-y;
    }

    .cart-item {
      background: var(--cream);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .cart-item-info { flex: 1; }
    .cart-item-info h4 { font-size: 16px; color: var(--brown); margin-bottom: 2px; }
    .cart-item-info .item-price { font-size: 14px; color: var(--gold); font-weight: 500; }
    .cart-item-info .item-min { font-size: 12px; color: var(--text-muted); }

    .qty-ctrl {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .qty-btn {
      width: 28px; height: 28px;
      border-radius: 50%;
      border: 1.5px solid var(--gold);
      background: none;
      color: var(--gold);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, color 0.15s;
      line-height: 1;
    }
    .qty-btn:hover { background: var(--gold); color: var(--white); }

    .qty-val { font-size: 15px; font-weight: 500; min-width: 20px; text-align: center; }

    .cart-item-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
    }
    .cart-line-total {
      font-family: 'Cormorant Garamond', serif;
      font-size: 16px;
      font-weight: 600;
      color: var(--brown);
      white-space: nowrap;
    }

    /* Image error fallback */
    img { background: linear-gradient(135deg, #e8d8c4, #d4b896); }

    .del-btn {
      background: none;
      border: none;
      color: #e07070;
      font-size: 18px;
      cursor: pointer;
      padding: 4px;
      transition: color 0.15s;
    }
    .del-btn:hover { color: #c04040; }

    .cart-empty {
      text-align: center;
      color: var(--text-muted);
      padding: 60px 0;
      font-size: 16px;
    }

    .cart-footer {
      padding: 14px 28px;
      padding-bottom: max(18px, calc(14px + env(safe-area-inset-bottom)));
      border-top: 1px solid var(--cream-dark);
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      max-height: 70vh;
    }

    .cart-total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .cart-total span:first-child { font-size: 15px; color: var(--brown); }
    .cart-total .total-val { font-family: 'Cormorant Garamond', serif; font-size: 24px; color: var(--gold); }
    .cart-footer .note { font-size: 11px; color: var(--text-muted); margin-bottom: 10px; }

    .cart-form { margin-top: 12px; }
    .cart-form h4 { font-size: 15px; color: var(--brown); margin-bottom: 10px; font-family: 'Jost',sans-serif; font-weight: 500; }

    .cart-actions { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }

    .btn-tg {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 16px;
      border-radius: 50px;
      font-family: 'Jost', sans-serif;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      transition: opacity 0.2s, transform 0.15s;
      text-decoration: none;
    }
    .btn-tg:hover { opacity: 0.9; transform: translateY(-1px); }
    .btn-tg.wa { background: #25D366; color: white; }
    .btn-tg.tg { background: #2AABEE; color: white; }
    .btn-tg.call { background: none; border: 1.5px solid #ddd; color: var(--brown); }

    .policy-note { font-size: 11px; color: var(--text-muted); text-align: center; margin-top: 10px; line-height: 1.5; }
    .policy-note a { color: var(--gold); }

    /* ── VK WIDGET SECTION ── */
    #vk-section {
      background: linear-gradient(180deg, var(--white) 0%, #f5efe4 100%);
      padding: 100px 60px;
    }
    .vk-section-inner {
      max-width: 900px;
      margin: 0 auto;
    }
    .vk-widget-wrap {
      display: flex;
      justify-content: center;
      margin-top: 48px;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 0 16px 60px rgba(61,43,31,0.12);
    }
    .vk-widget-wrap iframe {
      border-radius: 24px;
      width: 100%;
      max-width: 600px;
    }
    .vk-cta {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      margin-top: 32px;
      padding: 14px 28px;
      background: #0077FF;
      color: #fff;
      border-radius: 50px;
      text-decoration: none;
      font-family: 'Jost', sans-serif;
      font-size: 15px;
      font-weight: 500;
      box-shadow: 0 8px 24px rgba(0,119,255,0.3);
      transition: background 0.2s, transform 0.15s, box-shadow 0.2s;
    }
    .vk-cta:hover {
      background: #0066dd;
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0,119,255,0.4);
    }
    .vk-section-footer {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }
    .vk-section-sub {
      font-size: 14px;
      color: var(--text-muted);
      text-align: center;
    }
    @media (max-width: 900px) {
      #vk-section { padding: 70px 24px; }
    }

    /* ── ANIMATIONS ── */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to   { opacity: 1; }
    }

    /* ── WAVE DIVIDERS ── */
    .wave-divider {
      line-height: 0;
      overflow: hidden;
      pointer-events: none;
    }
    .wave-divider svg {
      display: block;
      width: 100%;
    }
    .wave-hero-catalog {
      background: #0d0805; /* hero bg color */
      margin-bottom: -1px;
    }
    .wave-catalog-why {
      background: #FDFBF7;
      margin-bottom: -1px;
    }
    .wave-stats-calc {
      background: var(--brown);
      margin-bottom: -1px;
    }

    /* ── STAGGER REVEAL ── */
    .reveal {
      opacity: 0;
      transform: translateY(28px);
      transition: opacity 0.65s ease, transform 0.65s ease;
    }
    .reveal.visible { opacity: 1; transform: none; }
    /* Stagger for catalog cards */
    .product-card.reveal:nth-child(1) { transition-delay: 0s; }
    .product-card.reveal:nth-child(2) { transition-delay: 0.08s; }
    .product-card.reveal:nth-child(3) { transition-delay: 0.16s; }
    .product-card.reveal:nth-child(4) { transition-delay: 0.24s; }
    .product-card.reveal:nth-child(5) { transition-delay: 0.32s; }
    .product-card.reveal:nth-child(6) { transition-delay: 0.40s; }
    /* Stagger for features */
    .feature.reveal:nth-child(1) { transition-delay: 0s; }
    .feature.reveal:nth-child(2) { transition-delay: 0.1s; }
    .feature.reveal:nth-child(3) { transition-delay: 0.2s; }
    .feature.reveal:nth-child(4) { transition-delay: 0.3s; }

    /* ── ANIMATED UNDERLINE ON SECTION TITLES ── */
    .section-title {
      position: relative;
      display: block;
      text-align: center;
      width: 100%;
      padding-bottom: 24px;
    }
    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0; left: 50%;
      transform: translateX(-50%) scaleX(0);
      width: 80px; height: 2px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      border-radius: 2px;
      transition: transform 0.6s 0.4s ease;
    }
    .section-title.visible::after { transform: translateX(-50%) scaleX(1); }

    /* ── FLOATING LABEL FORM ── */
    .form-group { margin-bottom: 22px; position: relative; }
    .form-group.float-label label {
      position: absolute;
      top: 15px; left: 18px;
      font-size: 14px;
      color: var(--text-muted);
      pointer-events: none;
      transition: top 0.22s ease, font-size 0.22s ease, color 0.22s ease;
      background: var(--cream);
      padding: 0 4px;
      border-radius: 3px;
      z-index: 1;
      margin-bottom: 0;
    }
    .form-group.float-label input:focus + label,
    .form-group.float-label input:not(:placeholder-shown) + label,
    .form-group.float-label textarea:focus + label,
    .form-group.float-label textarea:not(:placeholder-shown) + label {
      top: -9px;
      font-size: 11px;
      color: var(--gold);
      background: var(--white);
      letter-spacing: 0.03em;
    }
    .form-group.float-label input,
    .form-group.float-label textarea { padding-top: 16px; }
    /* Cart form uses white bg */
    .cart-form .form-group.float-label label { background: var(--white); }
    .cart-form .form-group.float-label input:not(:placeholder-shown) + label,
    .cart-form .form-group.float-label input:focus + label,
    .cart-form .form-group.float-label textarea:not(:placeholder-shown) + label,
    .cart-form .form-group.float-label textarea:focus + label { background: var(--white); }

    /* ── SECTION TITLE BLOCK ── */
    .section-title-wrap {
      text-align: center;
      margin-bottom: 64px;
    }
    .section-title-wrap .section-title { margin-bottom: 0; }
    .section-title-wrap .section-sub { margin-top: 48px; margin-bottom: 0; }

    /* ── RESPONSIVE ── */
    @media (max-width: 900px) {
      .hero { padding: 100px 30px 60px; }
      section { padding: 70px 30px; }
      .catalog-grid { grid-template-columns: 1fr 1fr; }
      .features-grid { grid-template-columns: 1fr 1fr; }
      .contacts-grid { grid-template-columns: 1fr; }
      .site-header { padding: 0 24px; }
      .stats-section { padding: 50px 30px; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 24px; }
      .rev-arrow { display: none; }
      #reviews { padding: 70px 16px !important; }
      .calc-wrap { padding: 28px 20px; }
      .floating-cta { display: none; }

    }
    @media (max-width: 560px) {
      .catalog-grid { grid-template-columns: 1fr; }
      .features-grid { grid-template-columns: 1fr 1fr; }
      .cart-drawer { 
        width: 100vw;
        right: -100vw;
      }
      .cart-drawer.open { right: 0; }
      .cart-header { padding: 20px 20px; }
      .cart-body { padding: 16px 20px; }
      .cart-footer { padding: 16px 20px; padding-bottom: max(24px, calc(16px + env(safe-area-inset-bottom))); }
      .cart-progress { padding: 12px 20px; }
      .hero-actions { flex-direction: column; align-items: flex-start; }
    }


    /* ── GEO DELIVERY BLOCK ── */
    .geo-section {
      background: var(--cream);
      padding: 50px 0 44px;
      border-top: 1px solid rgba(201,147,74,0.12);
    }
    .geo-section .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 40px;
    }
    .geo-section h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 22px;
      font-weight: 400;
      color: var(--brown);
      margin-bottom: 14px;
      letter-spacing: 0.02em;
    }
    .geo-section p {
      font-size: 14px;
      line-height: 1.8;
      color: var(--text-muted);
      margin-bottom: 18px;
      font-weight: 300;
    }
    .geo-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .geo-tag {
      font-size: 13px;
      font-weight: 300;
      color: var(--brown-light);
      background: rgba(201,147,74,0.08);
      border: 1px solid rgba(201,147,74,0.2);
      border-radius: 20px;
      padding: 5px 14px;
      white-space: nowrap;
      transition: background 0.2s;
    }
    @media (max-width: 600px) {
      .geo-section .container { padding: 0 24px; }
      .geo-section { padding: 36px 0 32px; }
    }
    /* ── SEO TEXT BLOCK ── */
    .seo-section {
      background: var(--cream-dark);
      padding: 60px 0 50px;
      border-top: 1px solid rgba(201,147,74,0.15);
    }
    .seo-section .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 40px;
    }
    .seo-section h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 22px;
      font-weight: 400;
      color: var(--brown);
      margin-bottom: 20px;
      letter-spacing: 0.02em;
    }
    .seo-section p {
      font-size: 14px;
      line-height: 1.8;
      color: var(--text-muted);
      margin-bottom: 14px;
      font-weight: 300;
    }
    .seo-section p:last-child { margin-bottom: 0; }
    @media (max-width: 600px) {
      .seo-section .container { padding: 0 24px; }
      .seo-section { padding: 40px 0 36px; }
    }
  </style>
</head>
<body>

<!-- ── PROGRESS BAR ── -->
<div id="scroll-progress"></div>

<!-- ── TOAST ── -->
<div class="toast" id="toast"></div>

<!-- ══════════ HEADER ══════════ -->
<header class="site-header" id="siteHeader">
  <a href="#home" class="header-logo">Milovi Cake</a>
  <nav class="header-nav">
    <a href="#catalog">Каталог</a>
    <a href="#fillings">Начинки</a>
    <a href="#reviews">Отзывы</a>
    <a href="#contacts">Контакты</a>
    <a href="#catalog" class="header-order">Заказать</a>
  </nav>
  <button class="burger-btn" id="burgerBtn" aria-label="Меню">
    <span></span><span></span><span></span>
  </button>
</header>

<!-- ── MOBILE MENU ── -->
<div class="mobile-menu" id="mobileMenu">
  <button class="mobile-menu-close" onclick="closeMobileMenu()">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg>
    Закрыть
  </button>
  <div class="mobile-menu-nav">
    <a href="#catalog" onclick="closeMobileMenu()">Каталог</a>
    <div class="mobile-menu-divider"></div>
    <a href="#fillings" onclick="closeMobileMenu()">Начинки</a>
    <div class="mobile-menu-divider"></div>
    <a href="#reviews" onclick="closeMobileMenu()">Отзывы</a>
    <div class="mobile-menu-divider"></div>
    <a href="#contacts" onclick="closeMobileMenu()">Контакты</a>
    <div class="mobile-menu-divider"></div>
    <a href="tel:+79119038886" class="mobile-menu-phone" onclick="closeMobileMenu()">
      <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 10.8 19.79 19.79 0 01.07 2.18 2 2 0 012.03 0h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
      +7 911 903 88 86
    </a>
  </div>
</div>

<!-- ── FLOATING CTA ── -->
<a href="#catalog" class="floating-cta" id="floatingCta">
  🎂 Заказать торт
</a>

<!-- ── LIGHTBOX ── -->
<div class="lightbox" id="lightbox">
  <button class="lightbox-close" onclick="closeLightbox()">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg>
    Закрыть
  </button>
  <img id="lightboxImg" src="" alt="" style="user-select:none; -webkit-user-drag:none;" />
  <div class="lightbox-nav hidden" id="lbNav">
    <button class="lightbox-arrow" onclick="lbNavigate(-1)" aria-label="Назад">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </button>
    <button class="lightbox-arrow" onclick="lbNavigate(1)" aria-label="Вперёд">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
    </button>
  </div>
</div>

<!-- ══════════ HERO ══════════ -->
<section class="hero" id="home">
  <div class="hero-photo-bg">
    <img src="img/head.webp" alt="Milovi Cake — авторские торты" />
  </div>

  <div class="hero-content">
    <div class="hero-text">
      <h1 class="hero-title"><span class="hero-title-brand">Milovi Cake</span></h1>
      <p style="margin-bottom: 28px;">Авторские торты и десерты<br>Свежесть под заказ</p>

      <!-- Hero features -->
      <div class="hero-features" style="display:flex; flex-direction:column; gap:12px; margin-bottom:40px; animation: fadeUp 0.8s 0.25s ease both;">
        <div class="hero-feature-item" style="display:flex; align-items:center; gap:12px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="rgba(255,220,150,0.85)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink:0">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span style="font-size:15px; font-weight:300; color:rgba(255,235,185,0.82); letter-spacing:0.02em;">Изготовление от 2 дней</span>
        </div>
        <div class="hero-feature-item" style="display:flex; align-items:center; gap:12px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="rgba(255,220,150,0.85)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink:0">
            <rect x="1" y="3" width="15" height="13" rx="1"/><path d="M16 8h4l3 3v5h-7V8z"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/>
          </svg>
          <span style="font-size:15px; font-weight:300; color:rgba(255,235,185,0.82); letter-spacing:0.02em;">Доставка по СПб и Ленобласти</span>
        </div>
        <div class="hero-feature-item" style="display:flex; align-items:center; gap:12px;">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="rgba(255,220,150,0.85)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink:0">
            <path d="M2 22 C2 22 6 17 12 17 C18 17 22 12 22 2 C22 2 12 2 7 7 C2 12 2 22 2 22z"/><path d="M2 22 L12 12"/>
          </svg>
          <span style="font-size:15px; font-weight:300; color:rgba(255,235,185,0.82); letter-spacing:0.02em;">Только натуральные продукты</span>
        </div>
      </div>

      <div class="hero-actions">
        <a href="#catalog" class="btn-primary">Заказать онлайн</a>
        <a href="tel:+79119038886" class="btn-phone">
          <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 10.8 19.79 19.79 0 01.07 2.18 2 2 0 012.03 0h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
          +7 911 903 88 86
        </a>
      </div>
    </div>
  </div>
</section>

<!-- ══════════ CATALOG ══════════ -->

<section id="catalog">
  <div class="container">
    <h2 class="section-title reveal">Наши Десерты</h2>
    <p class="section-sub reveal">Выберите свой любимый торт или десерт из нашей коллекции</p>
    <div class="catalog-grid" id="catalogGrid">
      <!-- rendered by JS -->
    </div>
  </div>
</section>

<!-- ══════════ FILLINGS / CALCULATOR ══════════ -->
<section id="fillings" class="fillings">
  <div class="container">
    <h2 class="section-title reveal">Начинки & Стоимость</h2>
    <p class="section-sub reveal">Выберите начинку и узнайте примерную цену</p>
    <div class="calc-wrap reveal">
      <div class="calc-row">
        <label>Тип торта</label>
        <div class="calc-options" id="calcType">
          <div class="calc-opt selected" data-price="2800" onclick="selectOpt(this,'calcType')">Бисквитный</div>
        </div>
      </div>
      <div class="calc-row" id="calcWeightRow">
        <label>Вес торта</label>
        <div class="calc-weight-stepper">
          <button class="calc-stepper-btn" id="calcWeightMinus" onclick="stepWeight(-1)" aria-label="Уменьшить вес">−</button>
          <div class="calc-stepper-val" id="calcWeightVal">2 кг</div>
          <button class="calc-stepper-btn" id="calcWeightPlus" onclick="stepWeight(1)" aria-label="Увеличить вес">+</button>
        </div>
        <div id="guestsPopup" style="
            margin-top: 8px;
            font-family: 'Jost', sans-serif;
            font-size: 9px;
            font-weight: 300;
            color: var(--text);
            letter-spacing: 0.06em;
            text-transform: uppercase;
            text-shadow: 0 1px 3px rgba(61,43,31,0.25), 0 2px 8px rgba(201,147,74,0.2);
            opacity: 0;
            transition: opacity 0.3s ease;
          ">Примерно на <span id="guestsCount">10 человек</span></div>
        <input type="hidden" id="calcWeight" value="2" />
      </div>
      <div class="calc-row" id="calcFillRow">
        <label>Начинка</label>
        <div class="calc-options" id="calcFill">
          <div class="calc-opt selected" data-price="0" data-desc="Бисквит ваниль + микс малины, вишни и лесных ягод + сливочный крем. Сочная ягодная классика." onclick="selectOpt(this,'calcFill')">Микс ягод <span class="fill-tag hit">хит</span><div class="fill-tooltip"><strong>Микс ягод</strong>Бисквит ваниль + микс малины, вишни и лесных ягод + сливочный крем. Сочная ягодная классика.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Белый шоколадный бисквит + карамельный крем + хрустящий арахис. Нежная «светлая» версия сникерса." onclick="selectOpt(this,'calcFill')">Белый сникерс <span class="fill-tag nuts">орехи</span><div class="fill-tooltip"><strong>Белый сникерс</strong>Белый шоколадный бисквит + карамельный крем + хрустящий арахис. Нежная светлая версия сникерса.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Шоколадный бисквит + солёная карамель + арахис + крем чиз. Классический сникерс — любимец всех возрастов." onclick="selectOpt(this,'calcFill')">Сникерс <span class="fill-tag nuts">орехи</span><div class="fill-tooltip"><strong>Сникерс</strong>Шоколадный бисквит + солёная карамель + арахис + крем чиз. Любимец всех возрастов.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Шоколадный бисквит + шоколадный сырный крем + молотый грецкий орех + вафельный хруст. Эффект конфеты Ferrero Rocher." onclick="selectOpt(this,'calcFill')">Ферреро <span class="fill-tag nuts">орехи</span><div class="fill-tooltip"><strong>Ферреро</strong>Шоколадный бисквит + шоколадный сырный крем + молотый грецкий орех + вафельный хруст. Эффект Ferrero Rocher.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Бисквит ваниль + клубничное конфи + нежный сливочный крем. Лёгкий, ягодный, ненавязчиво сладкий." onclick="selectOpt(this,'calcFill')">Воздушный поцелуй<div class="fill-tooltip"><strong>Воздушный поцелуй</strong>Бисквит ваниль + клубничное конфи + сливочный крем. Лёгкий, ягодный.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Бисквит ваниль + вишнёвое конфи + сливочный крем. Классическое сочетание сладкого и лёгкой кислинки." onclick="selectOpt(this,'calcFill')">Ванильная вишня<div class="fill-tooltip"><strong>Ванильная вишня</strong>Бисквит ваниль + вишнёвое конфи + сливочный крем. Сладкое с лёгкой кислинкой.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Бисквит ваниль + курд манго-маракуйя + крем чиз. Экзотично, свежо и солнечно." onclick="selectOpt(this,'calcFill')">Ванильные тропики<div class="fill-tooltip"><strong>Ванильные тропики</strong>Бисквит ваниль + курд манго-маракуйя + крем чиз. Экзотично и солнечно.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Ванильный бисквит + крем чиз. Нежно, идеально для маленьких детей и кормящих мам." onclick="selectOpt(this,'calcFill')">Ванильные облака<div class="fill-tooltip"><strong>Ванильные облака</strong>Ванильный бисквит + крем чиз. Нежно, для детей и кормящих мам.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Шоколадный бисквит + вишнёвое конфи + сливочный крем чиз. Интенсивный вишнёво-шоколадный аккорд." onclick="selectOpt(this,'calcFill')">Вишня в шоколаде<div class="fill-tooltip"><strong>Вишня в шоколаде</strong>Шоколадный бисквит + вишнёвое конфи + сливочный крем чиз.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Шоколадный бисквит + микс малины, вишни и лесных ягод + сливочный крем чиз. Насыщенный шоколад с ягодной свежестью." onclick="selectOpt(this,'calcFill')">Шоколадный микс ягод<div class="fill-tooltip"><strong>Шоколадный микс ягод</strong>Шоколадный бисквит + микс малины, вишни и лесных ягод + сливочный крем чиз.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Бисквит «красный бархат» + нежный сырный крем. Эффектный срез, бархатный вкус." onclick="selectOpt(this,'calcFill')">Красный бархат<div class="fill-tooltip"><strong>Красный бархат</strong>Бисквит красный бархат + нежный сырный крем. Эффектный срез, бархатный вкус.</div></div>
          <div class="calc-opt" data-price="0" data-desc="Шоколадный бисквит + шоколадный крем-чиз. Для любителей шоколада на шоколадном." onclick="selectOpt(this,'calcFill')">Супер-Шоколад<div class="fill-tooltip"><strong>Супер-Шоколад</strong>Шоколадный бисквит + шоколадный крем-чиз. Для истинных любителей шоколада.</div></div>
        </div>
      </div>
      <div class="calc-row">
        <label>Декор</label>
        <div class="calc-options" id="calcDecor">
          <div class="calc-opt selected" data-price="0" onclick="selectOpt(this,'calcDecor')">Без декора</div>
          <div class="calc-opt" data-price="500" onclick="selectOpt(this,'calcDecor')">Цветы</div>
          <div class="calc-opt" data-price="800" onclick="selectOpt(this,'calcDecor')">Фигурки</div>
          <div class="calc-opt" data-price="1200" onclick="selectOpt(this,'calcDecor')">Авторский Декор</div>
        </div>
      </div>
      <div class="calc-result">
        <div>
          <div class="calc-result-label" id="calcLabel">Примерная стоимость</div>
          <div class="calc-result-price" id="calcResult">5 600 ₽</div>
          <div class="calc-approx-badge" id="calcApproxBadge">⚠ Уточните точную цену при заказе</div>
          <div class="calc-result-note" id="calcNote">Точная цена согласовывается при заказе</div>
        </div>
        <a href="#contacts" class="calc-order-btn">Заказать 🎂</a>
      </div>
    </div>
  </div>
</section>

<!-- ══════════ WHY US ══════════ -->

<section id="why">
  <div class="container">
    <h2 class="section-title reveal">Почему Выбирают Нас</h2>
    <div class="features-grid">
      <div class="feature reveal">
        <div class="feature-icon">🤍</div>
        <h4>Ручная Работа</h4>
        <p>Каждый десерт создаётся с любовью и заботой вручную</p>
      </div>
      <div class="feature reveal">
        <div class="feature-icon">🌿</div>
        <h4>Натуральные Ингредиенты</h4>
        <p>Только качественные продукты без искусственных добавок</p>
      </div>
      <div class="feature reveal">
        <div class="feature-icon">🎯</div>
        <h4>Свежесть под заказ</h4>
        <p>Готовим специально для вас, всегда свежее</p>
      </div>
      <div class="feature reveal">
        <div class="feature-icon">📦</div>
        <h4>Доставка по СПб</h4>
        <p>Аккуратная доставка в красивой упаковке</p>
      </div>
    </div>
  </div>
</section>


<!-- ══════════ REVIEWS ══════════ -->
<section id="reviews" style="padding:100px 60px;">
  <div class="container">
    <h2 class="section-title reveal">Отзывы Клиентов</h2>
    <p class="section-sub reveal">Нам Пишут — Мы Очень Стараемся 🤍</p>
    <div class="reviews-carousel reveal">
      <button class="rev-arrow rev-prev" onclick="shiftReview(-1)" aria-label="Предыдущий">&#8592;</button>
      <div class="reviews-track" id="reviewsTrack">
        
        <div class="review-slide active">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Все гости в восторге! Мы тоже 👍 Попросили ваш контакт 😊</p>
            <div class="review-img-wrap">
              <img src="img/review_1.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Огромное Вам благодарность за самый вкуснейший торт!!! Ооочень вкусно!!!! Именинница в восторге и от вида и от вкуса!!! Вы лучшая!!</p>
            <div class="review-img-wrap">
              <img src="img/review_2.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Вы мастер своего дела ✨ Правда очень классный торт. Настроение сразу радостное глядя на него ❤️</p>
            <div class="review-img-wrap">
              <img src="img/review_3.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Очень очень вкусный, понравился. Ещё будем заказывать 🙏</p>
            <div class="review-img-wrap">
              <img src="img/review_4.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Всем очень понравился торт, именинница очень довольна. Очень видно, что душу вложили, мы это очень ценим!</p>
            <div class="review-img-wrap">
              <img src="img/review_5.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>

        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Спасибо большое за чудесный тортик! Все в восторге! Очень вкусно 😍</p>
            <div class="review-img-wrap">
              <img src="img/review_6.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Вика, насколько красиво — настолько и вкусно 😋 Клиентов стало больше у Вас ❤️</p>
            <div class="review-img-wrap">
              <img src="img/review_6.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
        <div class="review-slide">
          <div class="review-card">
            <div class="review-quote">❝</div>
            <p class="review-text">Торт изумителен 🤩 Вкусно. Профессионально. Стильно. Спасибо! ❤️</p>
            <div class="review-img-wrap">
              <img src="img/review_7.webp" alt="Отзыв клиента Milovi Cake" loading="lazy" />
            </div>
          </div>
        </div>
      </div>
      <button class="rev-arrow rev-next" onclick="shiftReview(1)" aria-label="Следующий">&#8594;</button>
    </div>
    <div class="rev-dots" id="revDots"><span class="rev-dot  rev-dot-active" onclick="goReview(0)"></span><span class="rev-dot" onclick="goReview(1)"></span><span class="rev-dot" onclick="goReview(2)"></span><span class="rev-dot" onclick="goReview(3)"></span><span class="rev-dot" onclick="goReview(4)"></span><span class="rev-dot" onclick="goReview(5)"></span><span class="rev-dot" onclick="goReview(6)"></span><span class="rev-dot" onclick="goReview(7)"></span></div>
  </div>
</section>
<!-- ══════════ STATS ══════════ -->
<div class="stats-section">
  <div class="stats-grid">
    <div class="stat-item reveal">
      <span class="stat-num" data-target="500" data-suffix="+">0</span>
      <div class="stat-label">Тортов создано</div>
    </div>
    <div class="stat-item reveal">
      <span class="stat-num" data-target="5" data-suffix=" лет">0</span>
      <div class="stat-label">Опыта работы</div>
    </div>
    <div class="stat-item reveal">
      <span class="stat-num" data-target="98" data-suffix="%">0</span>
      <div class="stat-label">Довольных клиентов</div>
    </div>
    <div class="stat-item reveal">
      <span class="stat-num" data-target="9" data-suffix=" видов">0</span>
      <div class="stat-label">Десертов в меню</div>
    </div>
  </div>
</div>



<!-- ══════════ CONTACTS ══════════ -->
<section id="contacts">
  <div class="container">
    <h2 class="section-title reveal">Свяжитесь с Нами</h2>
    <p class="section-sub reveal">Готовы сделать заказ? Мы всегда на связи!</p>
    <div class="contacts-grid">
      <div class="card reveal">
        <h3>Контакты</h3>
        <p class="hours">Отвечаем обычно за 5–10 минут · Ежедневно 10:00–20:00</p>

        <!-- Основные контакты -->
        <div class="contact-primary">
          <a href="tel:+79119038886" class="contact-primary-item">
            <div class="contact-primary-icon">
              <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 10.8 19.79 19.79 0 01.07 2.18 2 2 0 012.03 0h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
            </div>
            <div>
              <div class="contact-primary-label">Позвоните нам</div>
              <div class="contact-primary-value">+7 911 903 88 86</div>
            </div>
          </a>
          <a href="https://maps.app.goo.gl/6aCJvobUQPcBZTmz6" target="_blank" class="contact-primary-item">
            <div class="contact-primary-icon">
              <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/></svg>
            </div>
            <div>
              <div class="contact-primary-label">Самовывоз по предзаказу</div>
              <div class="contact-primary-value">Пулковская ул., 19, СПб</div>
            </div>
          </a>
        </div>

        <!-- CTA WhatsApp -->
        <a href="https://wa.me/79119038886?text=Здравствуйте!%20Хочу%20сделать%20заказ" target="_blank" class="btn-wa">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="flex-shrink:0"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
          Заказать через WhatsApp
        </a>

        <!-- Соцсети и отзывы -->
        <div class="social-divider">
          <span>Мы в соцсетях</span>
        </div>
        <div class="social-links">
          <a href="https://vk.com/milovi_cake" target="_blank" class="social-link vk">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.684 0H8.316C1.592 0 0 1.592 0 8.316v7.368C0 22.408 1.592 24 8.316 24h7.368C22.408 24 24 22.408 24 15.684V8.316C24 1.592 22.408 0 15.684 0zm3.692 17.123h-1.744c-.66 0-.864-.525-2.05-1.727-1.033-1-1.49-1.135-1.744-1.135-.356 0-.458.102-.458.593v1.575c0 .424-.135.678-1.253.678-1.846 0-3.896-1.118-5.335-3.202C5.044 10.8 4.06 8.494 4.06 8.087c0-.254.102-.491.593-.491h1.744c.44 0 .61.203.78.677.863 2.49 2.303 4.675 2.896 4.675.22 0 .322-.102.322-.66V9.721c-.068-1.186-.695-1.287-.695-1.71 0-.203.17-.407.44-.407h2.744c.373 0 .508.203.508.643v3.473c0 .372.17.508.271.508.22 0 .407-.136.813-.542 1.253-1.406 2.151-3.574 2.151-3.574.119-.254.322-.491.762-.491h1.744c.525 0 .644.27.525.643-.22 1.017-2.354 4.031-2.354 4.031-.186.305-.254.44 0 .78.186.254.796.779 1.203 1.253.745.847 1.32 1.558 1.473 2.05.17.49-.085.745-.576.745z"/></svg>
            ВКонтакте
          </a>
          <a href="https://t.me/MiloviCake" target="_blank" class="social-link tg">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0a12 12 0 00-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 01.171.325c.016.093.036.306.02.472-.18 1.898-.96 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
            Telegram
          </a>
          <a href="https://www.youtube.com/channel/UCMDnxfGZiBqcDzgUV1zjFpw" target="_blank" class="social-link yt">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 00-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 00.502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 002.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 002.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
            YouTube
          </a>
        </div>
        <div class="social-links" style="margin-top:10px">
          <a href="https://yandex.ru/maps/org/milovi_cake_torty_na_zakaz/89655951103/" target="_blank" class="social-link ya">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M11.998 0C5.366 0 0 5.367 0 12c0 6.634 5.366 12 11.998 12C18.633 24 24 18.634 24 12 24 5.367 18.633 0 11.998 0zm.004 4.457c1.748 0 3.15.47 4.205 1.41 1.056.94 1.583 2.198 1.583 3.77 0 1.133-.3 2.104-.9 2.912-.6.808-1.478 1.393-2.635 1.757L17.1 19.5h-2.818l-2.57-4.89h-1.04V19.5H8.13V4.457h3.872zm-.107 2.18H10.67v5.85h1.332c1.005 0 1.77-.245 2.297-.735.526-.49.79-1.19.79-2.1 0-.896-.261-1.58-.783-2.05-.522-.47-1.28-.705-2.275-.705-.046 0-.09.003-.136.004v.036z"/></svg>
            Яндекс Карты
          </a>
          <a href="https://maps.app.goo.gl/6aCJvobUQPcBZTmz6" target="_blank" class="social-link google">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
            Google Карты
          </a>
        </div>
      </div>

      <div class="card reveal">
        <h3>Форма заказа</h3>
        <p class="hours" style="opacity:0"> </p>
        <div class="form-group float-label">
          <input type="text" id="fname" placeholder=" " />
          <label for="fname">Как к Вам обращаться?</label>
        </div>
        <div class="form-group float-label">
          <input type="tel" id="fphone" placeholder=" " />
          <label for="fphone">Телефон</label>
        </div>
        <div class="form-group float-label">
          <textarea id="fcomment" placeholder=" "></textarea>
          <label for="fcomment">Комментарий — вес, декор, дата…</label>
        </div>
        <p class="form-note">Нажимая кнопку, вы соглашаетесь с <a href="#">обработкой персональных данных</a></p>
        <button class="btn-wa" onclick="sendFormWA()">Отправить Заказ</button>
      </div>
    </div>
  </div>
</section>

<!-- ══════════ CART BUTTON ══════════ -->
<button class="cart-btn" onclick="openCart()" aria-label="Корзина">
  🛒
  <span class="cart-badge" id="cartBadge">0</span>
</button>

<!-- ══════════ CART DRAWER ══════════ -->
<div class="cart-overlay" id="cartOverlay" onclick="closeCart()"></div>
<div class="cart-drawer" id="cartDrawer">
  <div class="cart-header">
    <h3>🛒 Ваш заказ <span class="cart-count-badge" id="cartCountBadge">0</span></h3>
    <button class="cart-close" onclick="closeCart()" title="Закрыть корзину" aria-label="Закрыть корзину">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg>
      <span style="font-size:11px;display:block;line-height:1;margin-top:2px;color:var(--text-muted);letter-spacing:0.02em">закрыть</span>
    </button>
  </div>
  <!-- Progress steps -->
  <div class="cart-progress" id="cartProgress">
    <div class="cart-step active" id="step1" onclick="navigateToStep(1)" style="cursor:pointer;" title="Перейти к выбору">
      <div class="cart-step-dot">1</div>
      <span>Выбор</span>
    </div>
    <div class="cart-step-line" id="stepLine1"></div>
    <div class="cart-step" id="step2" onclick="navigateToStep(2)" style="cursor:pointer;" title="Перейти к данным">
      <div class="cart-step-dot">2</div>
      <span>Данные</span>
    </div>
    <div class="cart-step-line" id="stepLine2"></div>
    <div class="cart-step" id="step3" id="step3" style="cursor:default;">
      <div class="cart-step-dot">3</div>
      <span>Отправка</span>
    </div>
  </div>
  <div class="cart-body" id="cartBody"></div>
  <div class="cart-footer" id="cartFooter" style="display:none">
    <div class="cart-total">
      <span>Итого:</span>
      <span class="total-val" id="cartTotal">0 ₽</span>
    </div>
    <p class="note">Дополнительный декор оплачивается отдельно.</p>

    <div class="cart-form">
      <div style="margin-bottom:12px;">
        <button onclick="goBackToCart()" style="background:none;border:1px solid var(--cream-dark);border-radius:50px;padding:7px 16px;font-size:13px;color:var(--text-muted);cursor:pointer;font-family:'Jost',sans-serif;display:inline-flex;align-items:center;gap:6px;transition:all 0.2s;" onmouseover="this.style.borderColor='var(--gold)';this.style.color='var(--brown)'" onmouseout="this.style.borderColor='var(--cream-dark)';this.style.color='var(--text-muted)'">
          ← Назад к выбору
        </button>
      </div>
      <h4>Ваши данные</h4>
      <div class="form-group float-label">
        <input type="text" id="cname" placeholder=" " />
        <label for="cname">Как к Вам обращаться?</label>
      </div>
      <div class="form-group float-label">
        <input type="tel" id="cphone" placeholder=" " />
        <label for="cphone">Телефон</label>
      </div>
      <div class="form-group float-label">
        <input type="text" id="cdate" placeholder=" " />
        <label for="cdate">Дата получения (дд.мм.гггг)</label>
      </div>
      <div class="form-group float-label">
        <textarea id="ccomment" placeholder=" " style="min-height:52px;"></textarea>
        <label for="ccomment">Вес, декор, доставка/самовывоз…</label>
      </div>
    </div>

    <div class="cart-actions">
      <a id="btnWA" href="#" target="_blank" class="btn-tg wa" onclick="buildWA(event)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
        Отправить в WhatsApp
      </a>
      <a id="btnTG" href="#" target="_blank" class="btn-tg tg" onclick="buildTG(event)">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0a12 12 0 00-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 01.171.325c.016.093.036.306.02.472-.18 1.898-.96 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg>
        Отправить в Telegram
      </a>
      <a href="tel:+79119038886" class="btn-tg call">
        📞 Позвонить +7 911 903 88 86
      </a>
    </div>
    <p class="policy-note">Нажимая кнопку, вы соглашаетесь с <a href="#">обработкой персональных данных</a></p>
  </div>
</div>

<!-- ══════════ GEO DELIVERY ══════════ -->
<section class="geo-section">
  <div class="container">
    <h2>Доставка тортов по Санкт-Петербургу и пригородам</h2>
    <p>Мы доставляем торты и десерты на заказ по всему Санкт-Петербургу, а также в пригороды и города Ленинградской области — Пушкин, Петергоф, Гатчину, Всеволожск, Колпино, Красное Село, Павловск, Сестрорецк, Ломоносов, Кронштадт, Тосно, Мурино, Кудрово, Шушары и другие. Доставка осуществляется собственной службой (по договорённости) или через Яндекс.Доставку. Самовывоз также доступен.</p>
    <div class="geo-tags">
      <a href="/pushkin/" class="geo-tag" style="text-decoration:none;">🎂 Торты в Пушкине →</a>
      <span class="geo-tag">Торты в Петергофе</span>
      <span class="geo-tag">Торты в Гатчине</span>
      <span class="geo-tag">Торты во Всеволожске</span>
      <span class="geo-tag">Торты в Колпино</span>
      <span class="geo-tag">Торты в Красном Селе</span>
      <span class="geo-tag">Торты в Павловске</span>
      <span class="geo-tag">Торты в Сестрорецке</span>
      <span class="geo-tag">Торты в Ломоносове</span>
      <span class="geo-tag">Торты в Кронштадте</span>
      <span class="geo-tag">Торты в Тосно</span>
      <span class="geo-tag">Торты в Мурино</span>
      <span class="geo-tag">Торты в Кудрово</span>
      <span class="geo-tag">Торты в Шушарах</span>
      <span class="geo-tag">Доставка по ЛО</span>
    </div>
  </div>
</section>


<!-- ══════════ SEO TEXT ══════════ -->
<section class="seo-section">
  <div class="container">
    <h2>Домашние торты на заказ в Санкт-Петербурге — Milovi Cake</h2>
    <p>В Milovi Cake мы готовим домашние торты на заказ в Санкт-Петербурге (СПб) для тех, кто ценит настоящий вкус и аккуратный, тёплый подход. Каждый торт собираем вручную, на натуральных сливках и качественном сыре крем-чиз, без готовых смесей и растительных заменителей. Вы выбираете вкус, размер и оформление — мы создаём десерт именно под ваш праздник.</p>
    <p>Любителям нежной классики подойдут наши ванильные торты на заказ. «Воздушный поцелуй» — сочный ванильный бисквит с клубничной начинкой и сливочным крем-чиз, идеален для девичника или романтического ужина. «Ванильная вишня» сочетает мягкий бисквит и насыщенную вишню. Для любителей свежих вкусов — «Ванильный микс ягод» с малиной, вишней, голубикой и чёрной смородиной, «Ванильные тропики» с курдом манго-маракуйя, «Белый сникерс» с домашней солёной карамелью и арахисом, «Ваниль в молочном шоколаде» с хрустящей вафлей.</p>
    <p>Если вы ищете шоколадный торт на заказ в СПб — «Вишня в шоколаде», «Шоколадный микс ягод», «Сникерс» с солёной карамелью и арахисом, «Ферреро» с хрустящей вафлей в молочном шоколаде и грецким орехом. Для любителей классики тортов на заказ — «Красный бархат» и домашний «Медовик» с мёдовыми коржами и сливочно-сметанным кремом.</p>
    <p>Отдельная гордость — меренговые рулеты на заказ в СПб и пирожное Павлова на заказ. Оба десерта готовятся по безглютеновым рецептам на основе взбитых белков — хрустящая корочка безе, нежный крем и свежие ягоды. Принимаем заказы на торты для дней рождения, свадеб, крестин, корпоративов и детских праздников. Доставка тортов по Санкт-Петербургу — собственная или через Яндекс.Доставку — и самовывоз.</p>
  </div>
</section>


<script>
// ── DATA ──
const products = [
  { id: 1, name: 'Бисквитный торт', desc: 'Воздушный торт с нежнейшим кремом и авторским декором', min: 'Заказ от 2 кг, декор рассчитывается отдельно', price: 'от 2 800 ₽/кг', priceNum: 2800, unit: 'кг', minKg: 2, emoji: '🎂',
    slides: ['img/cake_biscuit_0.webp', 'img/cake_biscuit_1.webp', 'img/cake_biscuit_2.webp', 'img/cake_biscuit_3.webp', 'img/cake_biscuit_4.webp', 'img/cake_biscuit_5.webp'],
    slidePos: ['center 30%', 'center 25%', 'center 20%', 'center 30%', 'center 20%'] },
  { id: 2, name: 'Бенто торт', desc: 'Миниатюрный торт — идеальный подарок для особенного момента', min: '', price: '1 600 ₽', priceNum: 1600, unit: 'шт', emoji: '🍰',
    slides: ['img/bento_1.webp', 'img/bento_2.webp', 'img/bento_4.webp'],
    slidePos: ['60% 50%', 'center 5%', 'center 40%'],
    slideScale: [1.4, 1, 1],
    hasMaxi: true,
    maxiVariant: {
      name: 'Макси Бенто',
      desc: 'Увеличенный бенто торт — больше радости, больше вкуса',
      price: 'от 3 000 ₽/кг',
      priceNum: 3000,
      unit: 'кг',
      minKg: 1,
      slides: ['data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAWkPXmowxu5cjsMmmS2W2ksqHfG4XHHJ616bdI5llmG7sBXhCGgDFTy2Ac1gqpcRldpB5OetABF0yzRq2GLYAYHpQTAo575o+VgAQuW7D4oJsI5LAt9jQhstt2YRsh9INYliyEMeck8mq4ZP3hBPB70Qm7/uBjx2NAIhcgQxuB6Q4AIHOajpU0ib1ziJvzg96lJODIC0eR7VOYRlQYe9AH//2Q=='],
      slidePos: ['center 40%'],
      slideScale: [1]
    }
  },
  { id: 3, name: '3D Торт', desc: 'Уникальный дизайнерский торт с объёмными элементами', min: 'Заказ от 3 кг', price: '4 000 ₽/кг', priceNum: 4000, unit: 'кг', minKg: 3, emoji: '✨',
    slides: ['img/cake_3d.webp', 'img/cake_3d_2.webp'],
    slidePos: ['center 15%', 'center 0%'],
    slideScale: [0.9, 1] },
  { id: 4, name: 'Меренговый рулет', desc: 'Хрустящая меренга с нежным кремом — наш фирменный десерт', min: '', price: '2 500 ₽/шт', priceNum: 2500, unit: 'шт', emoji: '🥐',
    slides: ['img/meringue_roll.webp', 'img/meringue_roll_2.webp', 'img/meringue_roll_3.webp'],
    slidePos: ['center 35%', 'center 40%', 'center 35%'] },
  { id: 5, name: 'Пирожное "Павлова"', desc: 'Воздушная меренга с кремом и начинкой из ягод', min: 'Заказ от 2 шт', price: '350 ₽/шт', priceNum: 350, unit: 'шт', emoji: '🍓',
    slides: ['img/pavlova.webp', 'img/pavlova_2.webp', 'img/pavlova_3.webp'],
    slidePos: ['center 55%', 'center 45%', 'center 50%'] },
  { id: 6, name: 'Капкейки', desc: 'Набор изящных капкейков с разными вкусами', min: 'Заказ от 6 шт одного вкуса', price: '350 ₽/шт', priceNum: 350, unit: 'шт', emoji: '🧁',
    slides: ['img/cupcakes.webp', 'img/cupcakes_2.webp'],
    slidePos: ['center 35%', 'center 40%', 'center 35%'] },
];

// cart: { [id]: { qty: number } }  — for kg-products qty is in kg (step 0.5)
let cart = {};

const slideTimers = {};

function renderCatalog() {
  Object.values(slideTimers).forEach(id => clearInterval(id));
  Object.keys(slideTimers).forEach(k => delete slideTimers[k]);

  const grid = document.getElementById('catalogGrid');
  grid.innerHTML = products.map(p => {
    let imgHtml;
    if (p.slides && p.slides.length) {
      const totalSlides = p.slides.length;
      imgHtml = `
        <div class="slider-wrap" id="slider-${p.id}">
          ${p.slides.map((src, i) => {
            const active = i === 0 ? ' active' : '';
            if (src && typeof src === 'object' && src.type === 'vk') {
              return `<div class="slide-img slide-video${active}" data-vk-embed="${src.embed}">
                <img src="${src.thumb}" alt="Видео" class="vk-thumb" style="width:100%;height:100%;object-fit:cover;object-position:center 35%;display:block;transition:opacity 0.3s;">
                <div class="slide-video-play" onclick="activateVkSlide(this)" aria-label="Смотреть видео">
                  <div class="vk-play-btn">
                    <svg width="56" height="56" viewBox="0 0 56 56" fill="none"><circle cx="28" cy="28" r="28" fill="rgba(0,0,0,0.52)"/><polygon points="23,18 43,28 23,38" fill="white"/></svg>
                    <span class="vk-play-label">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="white" style="margin-right:5px;flex-shrink:0"><path d="M15.684 0H8.316C1.592 0 0 1.592 0 8.316v7.368C0 22.408 1.592 24 8.316 24h7.368C22.408 24 24 22.408 24 15.684V8.316C24 1.592 22.408 0 15.684 0zm3.692 17.123h-1.744c-.66 0-.864-.525-2.05-1.727-1.033-1.01-1.49-1.135-1.744-1.135-.356 0-.458.102-.458.593v1.575c0 .424-.135.678-1.253.678-1.846 0-3.896-1.118-5.335-3.202C4.624 10.857 4 8.408 4 7.935c0-.254.102-.491.593-.491h1.744c.441 0 .61.203.78.677.863 2.49 2.303 4.675 2.896 4.675.22 0 .322-.102.322-.66V9.721c-.068-1.186-.695-1.287-.695-1.71 0-.203.17-.407.44-.407h2.744c.373 0 .508.203.508.643v3.473c0 .372.17.508.271.508.22 0 .407-.136.813-.542 1.253-1.406 2.15-3.574 2.15-3.574.119-.254.322-.491.763-.491h1.744c.525 0 .644.27.525.643-.22 1.017-2.354 4.031-2.354 4.031-.186.305-.254.44 0 .78.186.254.796.78 1.203 1.253.745.847 1.32 1.558 1.473 2.049.17.491-.085.745-.576.745z"/></svg>
                      Нажми для просмотра
                    </span>
                  </div>
                </div>
                <iframe class="vk-iframe" src="" frameborder="0" allow="autoplay; encrypted-media; fullscreen; picture-in-picture" allowfullscreen style="position:absolute;inset:0;width:100%;height:100%;border:0;display:none;"></iframe>
              </div>`;
            }
            const pos = p.slidePos ? p.slidePos[i] : 'center center';
            const scale = p.slideScale ? p.slideScale[i] : 1;
            return `<img src="${src}" alt="${p.name}" class="slide-img${active}"
              onerror="this.style.cssText='display:flex;align-items:center;justify-content:center;width:100%;aspect-ratio:1/1;font-size:60px;background:linear-gradient(135deg,#e8d8c4,#d4b896);'; this.src=''; this.alt='${p.emoji}'"
              style="object-position:${pos};transform:scale(${scale});transform-origin:${pos};">`;
          }).join('')}
          <div class="slider-dots">
            ${p.slides.map((s, i) => {
              const isVideo = s && typeof s === 'object' && s.type === 'vk';
              return `<span class="dot${i === 0 ? ' active' : ''}${isVideo ? ' dot-video' : ''}" onclick="goSlide(${p.id},${i})"></span>`;
            }).join('')}
          </div>
        </div>`;
    } else if (p.img) {
      imgHtml = `<img src="${p.img}" alt="${p.name}" class="product-img" onerror="this.style.cssText='display:flex;align-items:center;justify-content:center;width:100%;aspect-ratio:1/1;font-size:60px;background:linear-gradient(135deg,#e8d8c4,#d4b896);'; this.src=''; this.alt=p.emoji" style="object-position:${p.imgPos || 'center center'};">`;
    } else {
      imgHtml = `<div class="product-img-ph">${p.emoji}</div>`;
    }
    const titleHtml = p.hasMaxi
      ? `<div class="bento-header-row">
           <h3 id="name-${p.id}">${p.name}</h3>
           <div class="bento-seg" id="bento-pill-${p.id}">
             <span class="bento-seg-opt active" id="tab-regular-${p.id}" onclick="switchBentoTab(${p.id}, 'regular')" data-tip="~350 гр">Стандарт</span>
             <span class="bento-seg-opt" id="tab-maxi-${p.id}" onclick="switchBentoTab(${p.id}, 'maxi')" data-tip="~1100 гр">Макси</span>
           </div>
         </div>`
      : `<h3 id="name-${p.id}">${p.name}</h3>`;

    const pillHtml = '';

    return `
    <div class="product-card reveal" id="card-${p.id}">
      ${imgHtml}
      <div class="product-info">
        ${titleHtml}
        ${pillHtml}
        <p class="desc" id="desc-${p.id}">${p.desc}</p>
        <p class="min-order" id="min-${p.id}">${p.min || '\u00a0'}</p>
        <div class="product-footer">
          <span class="price" id="price-${p.id}">${p.price}</span>
          <button class="btn-add" onclick="addToCart(${p.id})">Добавить в корзину</button>
        </div>
      </div>
    </div>`;
  }).join('');

  // Auto-slide (store IDs to allow cleanup)
  products.forEach(p => {
    if (p.slides && p.slides.length > 1) {
      let cur = 0;
      slideTimers[p.id] = setInterval(() => {
        cur = (cur + 1) % p.slides.length;
        goSlide(p.id, cur);
      }, 3000);
      // Add touch swipe after DOM renders
      setTimeout(() => addSliderTouch(p.id, p.slides.length), 100);
    }
  });

  observeReveal();
}

function goSlide(pid, idx) {
  const wrap = document.getElementById('slider-' + pid);
  if (!wrap) return;
  const slides = wrap.querySelectorAll('.slide-img');
  slides.forEach((el, i) => {
    const wasActive = el.classList.contains('active');
    el.classList.toggle('active', i === idx);
    // Stop video if navigating away
    if (wasActive && i !== idx && el.classList.contains('slide-video')) {
      const iframe = el.querySelector('.vk-iframe');
      const thumb = el.querySelector('.vk-thumb');
      const playBtn = el.querySelector('.slide-video-play');
      if (iframe) { iframe.src = ''; iframe.style.display = 'none'; }
      if (thumb) thumb.style.opacity = '1';
      if (playBtn) playBtn.style.display = 'flex';
    }
  });
  wrap.querySelectorAll('.dot').forEach((el, i) => el.classList.toggle('active', i === idx));
}

function activateVkSlide(playBtn) {
  const slide = playBtn.closest('.slide-video');
  if (!slide) return;
  const iframe = slide.querySelector('.vk-iframe');
  const thumb = slide.querySelector('.vk-thumb');
  if (iframe) {
    iframe.src = slide.dataset.vkEmbed + '&autoplay=1';
    iframe.style.display = 'block';
  }
  if (thumb) thumb.style.opacity = '0';
  playBtn.style.display = 'none';
}

// ── PRODUCT SLIDER TOUCH SWIPE ──
function addSliderTouch(pid, total) {
  const wrap = document.getElementById('slider-' + pid);
  if (!wrap || wrap._touchBound) return;
  wrap._touchBound = true;
  let startX = 0;
  wrap.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
    wrap._wasSwiped = false;
  }, { passive: true });
  wrap.addEventListener('touchend', e => {
    const dx = e.changedTouches[0].clientX - startX;
    if (Math.abs(dx) < 40) return;
    wrap._wasSwiped = true;
    const dots = wrap.querySelectorAll('.dot');
    let cur = 0;
    dots.forEach((d, i) => { if (d.classList.contains('active')) cur = i; });
    const next = dx < 0 ? (cur + 1) % total : (cur - 1 + total) % total;
    goSlide(pid, next);
    if (slideTimers[pid]) {
      clearInterval(slideTimers[pid]);
      let c = next;
      slideTimers[pid] = setInterval(() => { c = (c + 1) % total; goSlide(pid, c); }, 3000);
    }
    // Reset swipe flag after click event fires
    setTimeout(() => { wrap._wasSwiped = false; }, 300);
  }, { passive: true });
}

// ── BENTO TAB SWITCHER ──
// Track current bento mode per product
const bentoModes = {};

function switchBentoTab(pid, mode) {
  const p = products.find(x => x.id === pid);
  if (!p || !p.hasMaxi) return;

  bentoModes[pid] = mode;
  const isMaxi = mode === 'maxi';
  const variant = isMaxi ? p.maxiVariant : p;

  // Show weight toast on mobile
  showBentoWeightToast(isMaxi ? '~1100 гр' : '~350 гр');

  // Update active title span
  const tabReg  = document.getElementById('tab-regular-' + pid);
  const tabMaxi = document.getElementById('tab-maxi-' + pid);
  if (tabReg)  tabReg.classList.toggle('active', !isMaxi);
  if (tabMaxi) tabMaxi.classList.toggle('active', isMaxi);

  // Update text fields (desc, min, price — name is handled by tabs)
  const descEl  = document.getElementById('desc-' + pid);
  const minEl   = document.getElementById('min-' + pid);
  const priceEl = document.getElementById('price-' + pid);
  if (descEl)  descEl.textContent  = variant.desc;
  if (minEl)   minEl.textContent   = variant.min || '\u00a0';
  if (priceEl) priceEl.textContent = variant.price;

  // Update images
  const wrap = document.getElementById('slider-' + pid);
  if (wrap) {
    const slides = variant.slides;
    const positions = variant.slidePos || slides.map(() => 'center center');
    const scales = variant.slideScale || slides.map(() => 1);

    // Clear current slides
    const existingSlides = wrap.querySelectorAll('.slide-img');
    existingSlides.forEach(el => el.remove());
    const dotsEl = wrap.querySelector('.slider-dots');

    // Build new slides
    let newSlidesHtml = '';
    slides.forEach((src, i) => {
      const active = i === 0 ? ' active' : '';
      newSlidesHtml += `<img src="${src}" alt="${variant.name}" class="slide-img${active}"
        onerror="this.style.cssText='display:flex;align-items:center;justify-content:center;width:100%;aspect-ratio:1/1;font-size:60px;background:linear-gradient(135deg,#e8d8c4,#d4b896);'; this.src=''; this.alt='🎂'"
        style="object-position:${positions[i]};transform:scale(${scales[i]});transform-origin:${positions[i]};">`;
    });
    if (dotsEl) {
      dotsEl.insertAdjacentHTML('beforebegin', newSlidesHtml);
      // Update dots
      dotsEl.innerHTML = slides.map((s, i) =>
        `<span class="dot${i === 0 ? ' active' : ''}" onclick="goSlide(${pid},${i})"></span>`
      ).join('');
    }

    // Restart auto-slide timer
    if (slideTimers[pid]) { clearInterval(slideTimers[pid]); delete slideTimers[pid]; }
    if (slides.length > 1) {
      let cur = 0;
      slideTimers[pid] = setInterval(() => {
        cur = (cur + 1) % slides.length;
        goSlide(pid, cur);
      }, 3000);
    }
  }
}

// ── LOCALSTORAGE CART ──
function saveCartToStorage() {
  try { localStorage.setItem('milovicake_cart', JSON.stringify(cart)); } catch(e) {}
}

function loadCartFromStorage() {
  try {
    const saved = localStorage.getItem('milovicake_cart');
    if (saved) {
      const parsed = JSON.parse(saved);
      // Validate: keep only items that exist in products
      Object.keys(parsed).forEach(id => {
        if (products.find(p => p.id === +id)) {
          cart[id] = parsed[id];
        }
      });
    }
  } catch(e) {}
}

function addToCart(id) {
  let p = products.find(x => x.id === id);
  // If bento and in maxi mode, use maxi variant data
  if (p && p.hasMaxi && bentoModes[id] === 'maxi') {
    p = { ...p, ...p.maxiVariant };
  }
  if (!cart[id]) {
    // Default: 1 шт or minimum kg
    const defaultQty = p.unit === 'кг' ? (p.minKg || 1) : 1;
    cart[id] = { qty: defaultQty };
  } else {
    const step = p.unit === 'кг' ? 0.5 : 1;
    cart[id].qty = Math.round((cart[id].qty + step) * 10) / 10;
  }
  updateCartUI();
  saveCartToStorage();
}

function removeFromCart(id) {
  delete cart[id];
  updateCartUI();
  saveCartToStorage();
}

function changeQty(id, delta) {
  const p = products.find(x => x.id === id);
  const step = p.unit === 'кг' ? 0.5 : 1;
  const minQty = p.unit === 'кг' ? (p.minKg || 1) : 1;
  cart[id].qty = Math.round((cart[id].qty + delta * step) * 10) / 10;
  if (cart[id].qty < minQty) {
    delete cart[id];
  }
  updateCartUI();
  saveCartToStorage();
}

function setCartStep(step) {
  // step 1 = items added, step 2 = filling form, step 3 = sent
  const steps = [
    document.getElementById('step1'),
    document.getElementById('step2'),
    document.getElementById('step3')
  ];
  const lines = [
    document.getElementById('stepLine1'),
    document.getElementById('stepLine2')
  ];
  if (!steps[0]) return;
  steps.forEach((s, i) => {
    s.classList.remove('active', 'done');
    if (i + 1 < step) s.classList.add('done');
    else if (i + 1 === step) s.classList.add('active');
  });
  lines.forEach((l, i) => {
    l.classList.toggle('done', i + 1 < step);
  });
}

function updateCartUI() {
  const totalItems = Object.keys(cart).length;
  const badge = document.getElementById('cartBadge');
  badge.textContent = totalItems;
  badge.classList.toggle('visible', totalItems > 0);
  document.getElementById('cartCountBadge').textContent = totalItems;

  const body = document.getElementById('cartBody');
  const footer = document.getElementById('cartFooter');

  const items = Object.entries(cart);
  if (!items.length) {
    body.innerHTML = `<div class="cart-empty">
      <div style="font-size:48px;margin-bottom:16px">🧁</div>
      <div style="font-size:18px;color:var(--brown);font-family:'Cormorant Garamond',serif;margin-bottom:8px">Корзина пуста</div>
      <div style="font-size:14px;color:var(--text-muted);margin-bottom:28px">Добавьте что-нибудь вкусное!</div>
      <a href="#catalog" onclick="closeCart()" style="display:inline-flex;align-items:center;gap:8px;background:var(--gold);color:#fff;padding:12px 24px;border-radius:50px;text-decoration:none;font-family:'Jost',sans-serif;font-size:14px;font-weight:500;box-shadow:0 6px 20px rgba(201,147,74,0.35)">
        Перейти в каталог →
      </a>
    </div>`;
    footer.style.display = 'none';
    return;
  }

  let total = 0;
  body.innerHTML = items.map(([id, entry]) => {
    const p = products.find(x => x.id === +id);
    const qty = entry.qty;
    const lineTotal = p.priceNum * qty;
    total += lineTotal;

    const isKg = p.unit === 'кг';
    const qtyLabel = isKg ? `${qty} кг` : `${qty} шт.`;
    const lineTotalFmt = lineTotal.toLocaleString('ru') + ' ₽';
    const minQty = isKg ? (p.minKg || 1) : 1;
    const atMin = qty <= minQty;

    return `
      <div class="cart-item">
        <div class="cart-item-info">
          <h4>${p.name}</h4>
          <div class="item-price">${p.price}</div>
          ${p.min ? `<div class="item-min">${p.min}</div>` : ''}
        </div>
        <div class="qty-ctrl">
          <button class="qty-btn" onclick="changeQty(${id}, -1)" ${atMin ? 'title="Минимальный заказ"' : ''}>−</button>
          <span class="qty-val">${qtyLabel}</span>
          <button class="qty-btn" onclick="changeQty(${id}, 1)">+</button>
        </div>
        <div class="cart-item-right">
          <div class="cart-line-total">${lineTotalFmt}</div>
          <button class="del-btn" onclick="removeFromCart(${id})" aria-label="Удалить">🗑</button>
        </div>
      </div>`;
  }).join('');

  const totalFmt = total.toLocaleString('ru') + ' ₽';
  document.getElementById('cartTotal').textContent = totalFmt;

  // Step 1: add summary + next button at bottom of cart-body
  body.innerHTML += `
    <div id="cartStep1Footer" style="margin-top:16px;padding-top:14px;border-top:1px solid var(--cream-dark);">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px;">
        <span style="font-size:15px;color:var(--brown);">Итого:</span>
        <span style="font-family:'Cormorant Garamond',serif;font-size:24px;color:var(--gold);">${totalFmt}</span>
      </div>
      <button onclick="goToFormStep()" style="width:100%;background:var(--gold);color:#fff;border:none;border-radius:50px;padding:14px 24px;font-size:15px;font-family:'Jost',sans-serif;font-weight:500;cursor:pointer;box-shadow:0 6px 20px rgba(201,147,74,0.35);">
        Далее →
      </button>
    </div>`;

  footer.style.display = 'none';
}

function goToFormStep() {
  setCartStep(2);
  document.getElementById('cartFooter').style.display = 'block';
  document.getElementById('cartBody').style.display = 'none';
}

function buildMessage() {
  const name = document.getElementById('cname').value.trim() || '—';
  const phone = document.getElementById('cphone').value.trim() || '—';
  const date = document.getElementById('cdate').value.trim() || '—';
  const comment = document.getElementById('ccomment').value.trim() || '—';

  if (!Object.keys(cart).length) { alert('Корзина пуста!'); return null; }
  if (!phone || phone === '—') { alert('Пожалуйста, укажите телефон.'); return null; }

  const items = Object.entries(cart).map(([id, entry]) => {
    const p = products.find(x => x.id === +id);
    const qty = entry.qty;
    const label = p.unit === 'кг' ? `${qty} кг` : `${qty} шт.`;
    return `• ${p.name} — ${label} (${p.price})`;
  }).join('\n');

  const total = Object.entries(cart).reduce((s, [id, entry]) => {
    const p = products.find(x => x.id === +id);
    return s + p.priceNum * entry.qty;
  }, 0);

    const fillEl = document.querySelector('#calcFill .selected');
  const fillLine = fillEl ? '\nНачинка: ' + fillEl.textContent.trim() : '';

  return `Привет! Хочу сделать заказ 🎂\n\n${items}${fillLine}\n\nИтого (ориентировочно): ${total.toLocaleString('ru')} ₽\n\nИмя: ${name}\nТелефон: ${phone}\nДата готовности: ${date}\nКомментарий: ${comment}`;
}

function buildWA(e) {
  setCartStep(3);
  e.preventDefault();
  const msg = buildMessage();
  if (!msg) return;
  window.open(`https://wa.me/79119038886?text=${encodeURIComponent(msg)}`, '_blank');
}

function buildTG(e) {
  e.preventDefault();
  const msg = buildMessage();
  if (!msg) return;
  navigator.clipboard.writeText(msg).then(() => {
    alert('Текст заказа скопирован! Вставьте его в чат Telegram (Ctrl+V / ⌘V).');
  }).catch(() => {});
  window.open('https://t.me/MiloviCake', '_blank');
}

function sendFormWA() {
  const name = document.getElementById('fname').value.trim() || '—';
  const phone = document.getElementById('fphone').value.trim();
  const comment = document.getElementById('fcomment').value.trim() || '—';
  if (!phone) { alert('Пожалуйста, укажите телефон.'); return; }
  const msg = encodeURIComponent(`Привет! 👋\nИмя: ${name}\nТелефон: ${phone}\nКомментарий: ${comment}`);
  window.open(`https://wa.me/79119038886?text=${msg}`, '_blank');
}

function navigateToStep(step) {
  const hasItems = Object.keys(cart).length > 0;
  if (!hasItems) return; // can't navigate if cart is empty

  if (step === 1) {
    goBackToCart();
  } else if (step === 2) {
    // Only go to step 2 if there are items
    goToFormStep();
  }
}

function goBackToCart() {
  setCartStep(1);
  document.getElementById('cartFooter').style.display = 'none';
  document.getElementById('cartBody').style.display = '';
  updateCartUI();
}

function openCart() {
  document.getElementById('cartDrawer').classList.add('open');
  document.getElementById('cartOverlay').classList.add('open');
  // iOS-safe scroll lock
  const scrollY = window.scrollY;
  document.body.style.position = 'fixed';
  document.body.style.top = `-${scrollY}px`;
  document.body.style.width = '100%';
  document.body.dataset.scrollY = scrollY;
  // Always start at step 1 (showing cart items)
  setCartStep(1);
  // Step advances only via explicit button (goToFormStep)
}

function closeCart() {
  document.getElementById('cartDrawer').classList.remove('open');
  document.getElementById('cartOverlay').classList.remove('open');
  // Restore scroll position
  const scrollY = parseInt(document.body.dataset.scrollY || '0');
  document.body.style.position = '';
  document.body.style.top = '';
  document.body.style.width = '';
  window.scrollTo(0, scrollY);
}

// ── PARALLAX ON HERO ORBS ──
(function() {
  const orbs = document.querySelectorAll('.hero-orb-1, .hero-orb-2, .hero-orb-3');
  let ticking = false;
  window.addEventListener('scroll', () => {
    if (ticking) return;
    ticking = true;
    requestAnimationFrame(() => {
      const y = window.scrollY;
      if (orbs[0]) orbs[0].style.transform = `translateY(${y * 0.15}px)`;
      if (orbs[1]) orbs[1].style.transform = `translateY(${y * -0.10}px)`;
      if (orbs[2]) orbs[2].style.transform = `translateY(${y * 0.08}px)`;
      ticking = false;
    });
  }, { passive: true });
})();

// ── SMOOTH IMAGE FADE-IN ON LOAD ──
document.querySelectorAll('img').forEach(img => {
  if (img.complete) return;
  img.style.opacity = '0';
  img.style.transition = 'opacity 0.5s ease';
  img.addEventListener('load', () => { img.style.opacity = '1'; });
});

// ── CART SWIPE-RIGHT TO CLOSE ──
(function() {
  const drawer = document.getElementById('cartDrawer');
  let startX = 0, startY = 0, dragging = false;
  drawer.addEventListener('touchstart', e => {
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
    dragging = true;
    drawer.style.transition = 'none';
  }, { passive: true });
  drawer.addEventListener('touchmove', e => {
    if (!dragging) return;
    const dx = e.touches[0].clientX - startX;
    const dy = Math.abs(e.touches[0].clientY - startY);
    if (dy > 30 && Math.abs(dx) < dy) { dragging = false; drawer.style.transition = ''; return; }
    if (dx > 0) drawer.style.transform = `translateX(${dx}px)`;
  }, { passive: true });
  drawer.addEventListener('touchend', e => {
    if (!dragging) return;
    dragging = false;
    drawer.style.transition = '';
    const dx = e.changedTouches[0].clientX - startX;
    if (dx > 100) {
      drawer.style.transform = '';
      closeCart();
    } else {
      drawer.style.transform = '';
    }
  }, { passive: true });
})();

// ── REVEAL ON SCROLL ──
function observeReveal() {
  const els = document.querySelectorAll('.reveal:not(.visible)');
  const io = new IntersectionObserver((entries) => {
    entries.forEach(e => { if (e.isIntersecting) { e.target.classList.add('visible'); io.unobserve(e.target); } });
  }, { threshold: 0.15 });
  els.forEach(el => io.observe(el));
}

renderCatalog(); // calls observeReveal() internally for catalog cards
setTimeout(wireProductLightbox, 200);
loadCartFromStorage();
updateCartUI();
observeReveal(); // picks up static .reveal elements (hero, sections, etc.)

// ── PROGRESS BAR ──
window.addEventListener('scroll', () => {
  const el = document.getElementById('scroll-progress');
  const scrolled = window.scrollY;
  const total = document.body.scrollHeight - window.innerHeight;
  el.style.width = (scrolled / total * 100) + '%';
});

// ── HEADER ON SCROLL ──
const header = document.getElementById('siteHeader');
window.addEventListener('scroll', () => {
  header.classList.toggle('scrolled', window.scrollY > 60);
});



// ── TOAST ──
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  clearTimeout(t._timer);
  t._timer = setTimeout(() => t.classList.remove('show'), 2800);
}

// Patch addToCart to show toast
const _origAdd = addToCart;
window.addToCart = function(id) {
  _origAdd(id);
  const p = products.find(x => x.id === id);
  const qty = cart[id] ? cart[id].qty : '';
  const label = p.unit === 'кг' ? `${qty} кг` : '';
  showToast(`🧁 ${p.name}${label ? ' · ' + label : ''} добавлен в корзину`);
};

// ── ANIMATED COUNTERS ──
function animateCounter(el) {
  const target = +el.dataset.target;
  const suffix = el.dataset.suffix || '';
  const duration = 1800;
  const start = performance.now();
  function step(now) {
    const progress = Math.min((now - start) / duration, 1);
    const eased = 1 - Math.pow(1 - progress, 3);
    el.textContent = Math.floor(eased * target) + suffix;
    if (progress < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

const counterObserver = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      animateCounter(e.target);
      counterObserver.unobserve(e.target);
    }
  });
}, { threshold: 0.4 });
document.querySelectorAll('.stat-num').forEach(el => counterObserver.observe(el));

// ── BURGER MENU ──
const burgerBtn = document.getElementById('burgerBtn');
const mobileMenu = document.getElementById('mobileMenu');
function closeMobileMenu() {
  burgerBtn.classList.remove('open');
  mobileMenu.classList.remove('open');
  document.body.style.overflow = '';
}
burgerBtn.addEventListener('click', () => {
  const isOpen = burgerBtn.classList.toggle('open');
  mobileMenu.classList.toggle('open', isOpen);
  document.body.style.overflow = isOpen ? 'hidden' : '';
});

// ── FLOATING CTA ──
const floatingCta = document.getElementById('floatingCta');
const contactsSection = document.getElementById('contacts');
window.addEventListener('scroll', () => {
  const scrolled = window.scrollY > 300;
  const nearBottom = contactsSection && window.scrollY + window.innerHeight > contactsSection.offsetTop - 100;
  floatingCta.classList.toggle('visible', scrolled && !nearBottom);
});

// ── LIGHTBOX ──
// ── LIGHTBOX with gallery + swipe ──
let _lbSrcs = [], _lbIdx = 0;

function openLightbox(src, srcs) {
  _lbSrcs = srcs || [src];
  // Normalize: find index by matching end of path
  _lbIdx = _lbSrcs.findIndex(s => src.endsWith(s) || s.endsWith(src) || src === s);
  if (_lbIdx < 0) _lbIdx = 0;
  const lb = document.getElementById('lightbox');
  document.getElementById('lightboxImg').src = _lbSrcs[_lbIdx];
  lb.classList.add('open');
  document.body.style.overflow = 'hidden';
  _lbUpdateArrows();
}
function lbNavigate(dir) {
  if (_lbSrcs.length < 2) return;
  _lbIdx = (_lbIdx + dir + _lbSrcs.length) % _lbSrcs.length;
  const img = document.getElementById('lightboxImg');
  img.style.opacity = '0';
  img.style.transition = 'opacity 0.15s';
  setTimeout(() => {
    img.src = _lbSrcs[_lbIdx];
    img.style.opacity = '1';
  }, 150);
  _lbUpdateArrows();
}
function _lbUpdateArrows() {
  const show = _lbSrcs.length > 1;
  document.getElementById('lbNav').classList.toggle('hidden', !show);
}
function closeLightbox() {
  document.getElementById('lightbox').classList.remove('open');
  document.body.style.overflow = '';
  _lbSrcs = []; _lbIdx = 0;
}
document.addEventListener('keydown', e => {
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowRight') lbNavigate(1);
  if (e.key === 'ArrowLeft') lbNavigate(-1);
});

// Click on backdrop closes lightbox
document.getElementById('lightbox').addEventListener('click', function(e) {
  if (e.target === this) closeLightbox();
});

// Swipe on lightbox
(function() {
  const lb = document.getElementById('lightbox');
  let sx = 0;
  lb.addEventListener('touchstart', e => { sx = e.touches[0].clientX; }, { passive: true });
  lb.addEventListener('touchend', e => {
    const dx = e.changedTouches[0].clientX - sx;
    if (Math.abs(dx) > 50) lbNavigate(dx < 0 ? 1 : -1);
  }, { passive: true });
})();

// Wire up review images
setTimeout(() => {
  document.querySelectorAll('.review-img-wrap img').forEach(img => {
    img.style.cursor = 'zoom-in';
    img.addEventListener('click', () => openLightbox(img.src));
  });
}, 100);

// Wire up product card images (called after renderCatalog)
function wireProductLightbox() {
  products.forEach(p => {
    if (!p.slides || p.slides.length === 0) return;
    const wrap = document.getElementById('slider-' + p.id);
    if (!wrap || wrap._lbBound) return;
    wrap._lbBound = true;

    // Use event delegation on the wrap — works even after bento tab switches new imgs in
    wrap.addEventListener('click', (e) => {
      if (wrap._wasSwiped) return;
      const img = e.target.closest('.slide-img');
      if (!img || img.classList.contains('slide-video')) return;

      // Find which slide is currently active by dot index
      const dots = wrap.querySelectorAll('.dot');
      let activeIdx = 0;
      dots.forEach((d, i) => { if (d.classList.contains('active')) activeIdx = i; });

      // Get current slides list (bento may have switched to maxi)
      const mode = typeof bentoModes !== 'undefined' && bentoModes[p.id];
      const currentSlides = (mode === 'maxi' && p.maxiVariant) ? p.maxiVariant.slides : p.slides;

      openLightbox(currentSlides[activeIdx], currentSlides);
    });
  });
}

// ── CALCULATOR ──
let _calcWeight = 2;
const WEIGHT_MIN = 2, WEIGHT_MAX = 10, WEIGHT_STEP = 0.5;

let _guestsTimer = null;
function stepWeight(dir) {
  const newVal = Math.round((_calcWeight + dir * WEIGHT_STEP) * 10) / 10;
  if (newVal < WEIGHT_MIN || newVal > WEIGHT_MAX) return;
  _calcWeight = newVal;
  document.getElementById('calcWeight').value = _calcWeight;
  updateCalc();
  const popup = document.getElementById('guestsPopup');
  if (popup) popup.style.opacity = '1';
}

function selectOpt(el, groupId) {
  document.querySelectorAll(`#${groupId} .calc-opt`).forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
  if (groupId === 'calcType') {
    document.getElementById('calcWeightRow').style.display = 'block';
    document.getElementById('calcFillRow').style.display = 'block';
  }
  updateCalc();
}

function updateCalc() {
  const typeEl = document.querySelector('#calcType .selected');
  const fillEl = document.querySelector('#calcFill .selected');
  const decorEl = document.querySelector('#calcDecor .selected');

  const basePrice = +(typeEl?.dataset.price || 2800);
  const fillPrice = +(fillEl?.dataset.price || 0);
  const decorPrice = +(decorEl?.dataset.price || 0);
  const weight = _calcWeight;

  // Update stepper display
  const valEl = document.getElementById('calcWeightVal');
  if (valEl) {
    valEl.textContent = weight % 1 === 0 ? weight + ' кг' : weight.toFixed(1) + ' кг';
  }
  const guestsEl = document.getElementById('guestsCount');
  if (guestsEl) {
    const n = Math.round(weight / 0.2);
    const mod10 = n % 10;
    const mod100 = n % 100;
    let form;
    if (mod100 >= 11 && mod100 <= 19) {
      form = 'человек';
    } else if (mod10 === 1) {
      form = 'человек'; // 1, 21, 31 — «на 1 человека» но мы говорим «примерно на N»
    } else if (mod10 >= 2 && mod10 <= 4) {
      form = 'человека';
    } else {
      form = 'человек';
    }
    guestsEl.textContent = n + ' ' + form;
  }

  // Update stepper button states
  const minusBtn = document.getElementById('calcWeightMinus');
  const plusBtn = document.getElementById('calcWeightPlus');
  if (minusBtn) minusBtn.disabled = weight <= WEIGHT_MIN;
  if (plusBtn) plusBtn.disabled = weight >= WEIGHT_MAX;

  let total = basePrice * weight + decorPrice;

  const decorIsNonStandard = decorPrice > 0;
  const isApprox = decorIsNonStandard;
  const prefix = isApprox ? '~ ' : '';
  document.getElementById('calcResult').textContent = prefix + total.toLocaleString('ru') + ' ₽';

  const badge = document.getElementById('calcApproxBadge');
  badge.classList.toggle('visible', isApprox);

  let noteText = 'Точная цена согласовывается при заказе';
  const notes = [];
  if (decorIsNonStandard) notes.push('декор рассчитывается отдельно');
  if (notes.length) noteText = '* ' + notes.map(n => n[0].toUpperCase() + n.slice(1)).join(', ');
  document.getElementById('calcNote').textContent = noteText;
}





let currentReview = 0;
const totalReviews = document.querySelectorAll('.review-slide').length;

function goReview(idx) {
  const slides = document.querySelectorAll('.review-slide');
  const dots = document.querySelectorAll('.rev-dot');
  slides[currentReview].classList.remove('active');
  dots[currentReview].classList.remove('rev-dot-active');
  currentReview = (idx + totalReviews) % totalReviews;
  slides[currentReview].classList.add('active');
  dots[currentReview].classList.add('rev-dot-active');
}

function shiftReview(dir) { goReview(currentReview + dir); }

// Auto-advance reviews every 5s
setInterval(() => shiftReview(1), 5000);

// Touch swipe support for reviews
let touchStartX = 0;
document.getElementById('reviewsTrack').addEventListener('touchstart', e => {
  touchStartX = e.touches[0].clientX;
}, { passive: true });
document.getElementById('reviewsTrack').addEventListener('touchend', e => {
  const dx = e.changedTouches[0].clientX - touchStartX;
  if (Math.abs(dx) > 40) shiftReview(dx < 0 ? 1 : -1);
}, { passive: true });
</script>
<!-- ══════════ FOOTER ══════════ -->
<footer style="background: var(--brown); padding: 18px 40px; text-align: center;">
  <p style="font-family: 'Cormorant Garamond', serif; font-size: 14px; font-weight: 400; letter-spacing: 0.18em; text-transform: uppercase; color: rgba(255,235,185,0.35);">© 2026 Milovi Cake</p>
</footer>

<div class="bento-weight-toast" id="bentoWeightToast"></div>

<script>
// Mobile weight toast on bento switch
let bentoToastTimer = null;
function showBentoWeightToast(text) {
  if (window.matchMedia('(hover: hover)').matches) return; // desktop uses CSS tooltip
  const toast = document.getElementById('bentoWeightToast');
  if (!toast) return;
  toast.textContent = text;
  toast.classList.add('show');
  clearTimeout(bentoToastTimer);
  bentoToastTimer = setTimeout(() => toast.classList.remove('show'), 2000);
}
</script>

<div class="fill-mobile-overlay" id="fillOverlay" onclick="closeFillPopup()"></div>
<div class="fill-mobile-popup" id="fillPopup">
  <button class="fill-mobile-popup-close" onclick="closeFillPopup()">×</button>
  <strong id="fillPopupTitle"></strong>
  <span id="fillPopupText"></span>
</div>

</body>
</html>
